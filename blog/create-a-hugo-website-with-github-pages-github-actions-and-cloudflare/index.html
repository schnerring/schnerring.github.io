<!doctype html><html lang=en data-theme=dark><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preload as=font type=font/woff2 href=/fonts/roboto-slab-latin-400.woff2 crossorigin=anonymous><link rel=preload as=font type=font/woff2 href=/fonts/roboto-slab-latin-700.woff2 crossorigin=anonymous><link rel=preload as=font type=font/woff2 href=/fonts/fira-code-latin-300.woff2 crossorigin=anonymous><link rel=preload as=font type=font/woff2 href=/fonts/fira-code-latin-400.woff2 crossorigin=anonymous><link rel=preload as=font type=font/woff2 href=/fonts/fira-code-latin-700.woff2 crossorigin=anonymous><meta name=robots content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Create a Hugo Website with GitHub Pages, GitHub Actions, and Cloudflare</title><meta name=description content="In this beginner guide, you&amp;rsquo;ll create a Hugo website from scratch and publish the website on GitHub Pages. You&amp;rsquo;ll configure Cloudflare&amp;rsquo;s DNS and utilize its caching capabilities to optimize page speeds. Finally, implementing automated deployments with GitHub Pages will enable you to publish new content on your site easily.
"><link rel=canonical href=https://schnerring.net/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://schnerring.net/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cover.jpg"><meta name=twitter:title content="Create a Hugo Website with GitHub Pages, GitHub Actions, and Cloudflare"><meta name=twitter:description content="In this beginner guide, you&rsquo;ll create a Hugo website from scratch and publish the website on GitHub Pages. You&rsquo;ll configure Cloudflare&rsquo;s DNS and utilize its caching capabilities to optimize page speeds. Finally, implementing automated deployments with GitHub Pages will enable you to publish new content on your site easily."><meta property="og:title" content="Create a Hugo Website with GitHub Pages, GitHub Actions, and Cloudflare"><meta property="og:description" content="In this beginner guide, you&rsquo;ll create a Hugo website from scratch and publish the website on GitHub Pages. You&rsquo;ll configure Cloudflare&rsquo;s DNS and utilize its caching capabilities to optimize page speeds. Finally, implementing automated deployments with GitHub Pages will enable you to publish new content on your site easily."><meta property="og:type" content="article"><meta property="og:url" content="https://schnerring.net/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/"><meta property="og:image" content="https://schnerring.net/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cover.jpg"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-03-19T21:14:22+01:00"><meta property="article:modified_time" content="2022-01-16T17:57:18+01:00"><meta itemprop=name content="Create a Hugo Website with GitHub Pages, GitHub Actions, and Cloudflare"><meta itemprop=description content="In this beginner guide, you&rsquo;ll create a Hugo website from scratch and publish the website on GitHub Pages. You&rsquo;ll configure Cloudflare&rsquo;s DNS and utilize its caching capabilities to optimize page speeds. Finally, implementing automated deployments with GitHub Pages will enable you to publish new content on your site easily."><meta itemprop=datePublished content="2021-03-19T21:14:22+01:00"><meta itemprop=dateModified content="2022-01-16T17:57:18+01:00"><meta itemprop=wordCount content="3695"><meta itemprop=image content="https://schnerring.net/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cover.jpg"><meta itemprop=keywords content="Hugo,Cloudflare,GitHub Actions,GitHub Pages,"><script async defer data-domain=schnerring.net src=https://plausible.schnerring.net/js/plausible.js></script><style>@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:100;src:local("Roboto Slab Thin "),local("Roboto Slab-Thin"),url(/fonts/roboto-slab-latin-100.woff2) format("woff2"),url(/fonts/roboto-slab-latin-100.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:200;src:local("Roboto Slab Extra Light "),local("Roboto Slab-Extra Light"),url(/fonts/roboto-slab-latin-200.woff2) format("woff2"),url(/fonts/roboto-slab-latin-200.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:300;src:local("Roboto Slab Light "),local("Roboto Slab-Light"),url(/fonts/roboto-slab-latin-300.woff2) format("woff2"),url(/fonts/roboto-slab-latin-300.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:400;src:local("Roboto Slab Regular "),local("Roboto Slab-Regular"),url(/fonts/roboto-slab-latin-400.woff2) format("woff2"),url(/fonts/roboto-slab-latin-400.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:500;src:local("Roboto Slab Medium "),local("Roboto Slab-Medium"),url(/fonts/roboto-slab-latin-500.woff2) format("woff2"),url(/fonts/roboto-slab-latin-500.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:600;src:local("Roboto Slab SemiBold "),local("Roboto Slab-SemiBold"),url(/fonts/roboto-slab-latin-600.woff2) format("woff2"),url(/fonts/roboto-slab-latin-600.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:700;src:local("Roboto Slab Bold "),local("Roboto Slab-Bold"),url(/fonts/roboto-slab-latin-700.woff2) format("woff2"),url(/fonts/roboto-slab-latin-700.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:800;src:local("Roboto Slab ExtraBold "),local("Roboto Slab-ExtraBold"),url(/fonts/roboto-slab-latin-800.woff2) format("woff2"),url(/fonts/roboto-slab-latin-800.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto Slab;font-style:normal;font-weight:900;src:local("Roboto Slab Black "),local("Roboto Slab-Black"),url(/fonts/roboto-slab-latin-900.woff2) format("woff2"),url(/fonts/roboto-slab-latin-900.woff) format("woff")}@font-face{font-display:swap;font-family:Fira Code;font-style:normal;font-weight:300;src:local("Fira Code Light "),local("Fira Code-Light"),url(/fonts/fira-code-latin-300.woff2) format("woff2"),url(/fonts/fira-code-latin-300.woff) format("woff")}@font-face{font-display:swap;font-family:Fira Code;font-style:normal;font-weight:400;src:local("Fira Code Regular "),local("Fira Code-Regular"),url(/fonts/fira-code-latin-400.woff2) format("woff2"),url(/fonts/fira-code-latin-400.woff) format("woff")}@font-face{font-display:swap;font-family:Fira Code;font-style:normal;font-weight:500;src:local("Fira Code Medium "),local("Fira Code-Medium"),url(/fonts/fira-code-latin-500.woff2) format("woff2"),url(/fonts/fira-code-latin-500.woff) format("woff")}@font-face{font-display:swap;font-family:Fira Code;font-style:normal;font-weight:600;src:local("Fira Code SemiBold "),local("Fira Code-SemiBold"),url(/fonts/fira-code-latin-600.woff2) format("woff2"),url(/fonts/fira-code-latin-600.woff) format("woff")}@font-face{font-display:swap;font-family:Fira Code;font-style:normal;font-weight:700;src:local("Fira Code Bold "),local("Fira Code-Bold"),url(/fonts/fira-code-latin-700.woff2) format("woff2"),url(/fonts/fira-code-latin-700.woff) format("woff")}

/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;-webkit-text-decoration:underline;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}

/*! CC BY-SA 3.0 License | https://stackoverflow.com/a/36118384/1154965 */@keyframes blink{50%{opacity:0}to{opacity:1}}

/*! MIT License | github.com/schnerring/hugo-theme-gruvbox */:root[data-theme=light]{--bg:var(--bg0_h);--bg0:#fbf1c7;--bg0_h:#f9f5d7;--bg0_s:#f2e5bc;--bg1:#ebdbb2;--bg2:#d5c4a1;--bg3:#bdae93;--bg4:#a89984;--fg:var(--fg1);--fg0:#282828;--fg1:#3c3836;--fg2:#504945;--fg3:#665c54;--fg4:#7c6f64;--gray1:var(--fg4);--gray2:#928374;--red1:#cc241d;--red2:#9d0006;--green1:#98971a;--green2:#797403;--yellow1:#d79921;--yellow2:#b57614;--blue1:#458588;--blue2:#076678;--purple1:#b16286;--purple2:#8f3f71;--aqua1:#689d6a;--aqua2:#427b58;--orange1:#d65d0e;--orange2:#af3a03}[data-theme=light]:root .light--hidden{display:none}:root[data-theme=dark]{--bg:var(--bg0_h);--bg0:#282828;--bg0_h:#1d2021;--bg0_s:#32302f;--bg1:#3c3836;--bg2:#504945;--bg3:#665c54;--bg4:#7c6f64;--fg:var(--fg1);--fg0:#fbf1c7;--fg1:#ebdbb2;--fg2:#d5c4a1;--fg3:#bdae93;--fg4:#a89984;--gray1:var(--fg4);--gray2:#928374;--red1:#cc241d;--red2:#fb4934;--green1:#98971a;--green2:#b8bb26;--yellow1:#d79921;--yellow2:#fabd2f;--blue1:#458588;--blue2:#83a598;--purple1:#b16286;--purple2:#d3869b;--aqua1:#689d6a;--aqua2:#8ec07c;--orange1:#d65d0e;--orange2:#fe8019}[data-theme=dark]:root .dark--hidden{display:none}:root{--primary:var(--aqua1);--primary-alt:var(--aqua2);--font-monospace:"Fira Code","Lucida Console",Monaco,monospace;--font-sans-serif:Verdana,Helvetica,sans-serif;--font-serif:"Roboto Slab",Georgia,serif}html{font-family:Roboto Slab,Georgia,serif;font-family:var(--font-serif);font-size:1rem;scroll-behavior:smooth}body{background:var(--bg);color:var(--fg);line-height:1.675;word-wrap:break-word}strong{letter-spacing:.35px}a{color:inherit;-webkit-text-decoration:none;text-decoration:none}a.link--external:after{content:"\2009↗"}img,video{border:2px solid var(--bg1);height:auto;max-width:100%}figure{display:inline-block}figcaption{color:var(--fg3);font-family:Roboto Slab,Georgia,serif;font-family:var(--font-serif);font-size:.9rem}::-moz-selection{background:var(--bg4);color:var(--fg0)}::selection{background:var(--bg4);color:var(--fg0)}h1,h2,h3,h4,h5{color:var(--fg0);font-family:Fira Code,Lucida Console,Monaco,monospace;font-family:var(--font-monospace);font-weight:300;line-height:1.4}h1 code,h2 code,h3 code,h4 code,h5 code{font-size:1em}h2,h3,h4,h5{border-bottom:1px solid var(--bg1)}h1,h2{font-weight:400}h1{font-size:1.875rem}h2{font-size:1.75rem}h3{font-size:1.625rem}@media (min-width:768px){h1{font-size:2.375rem}h2{font-size:2rem}h3{font-size:1.75rem}}h4{font-size:1.5rem}h5{font-size:1.375rem}table{border-collapse:collapse;margin:2rem 0;table-layout:fixed;width:100%}table,td,th{border:1px solid var(--bg1);padding:.5rem}hr{background:var(--bg1);border:none;height:1px;margin:3rem auto;width:80%}blockquote,code,pre{border-radius:.2rem;padding:0 .2em}pre code{padding:0}blockquote,code,pre,th{background:var(--bg1)}code,pre,th{font-family:Fira Code,Lucida Console,Monaco,monospace;font-family:var(--font-monospace)}code code{background:var(--bg2)}blockquote,pre{padding:1rem}pre{background:var(--bg1)!important;overflow:auto}pre code{background:none}blockquote{border-left:5px solid var(--primary-alt);margin:.5rem 0}blockquote:not(.does-not-exist) code{background:var(--bg2)}blockquote:not(.does-not-exist) p:first-of-type{margin-top:0}blockquote:not(.does-not-exist) p:last-of-type{margin-bottom:0}pre::-webkit-scrollbar{height:.5rem;scrollbar-width:auto}pre::-webkit-scrollbar-track{background:var(--bg2);border-radius:.2rem}pre::-webkit-scrollbar-thumb{background:var(--bg4);border-radius:.2rem}.layout{display:grid;grid-template-areas:"header" "main" "footer";grid-template-rows:auto 1fr auto;height:100vh}main{align-items:start;display:grid;grid-area:main;grid-template-areas:"empty content sidebar";grid-template-columns:1fr minmax(0,650px) 4fr}header{background:var(--bg1);grid-area:header}footer{grid-area:footer}footer,main{margin:.5em 1.1em}.content{grid-area:content}.sidebar{display:none;flex-direction:column;grid-area:sidebar;margin-top:3rem;position:sticky;top:2rem}@media (min-width:992px){.sidebar{display:flex}}header{display:grid;font-family:Fira Code,Lucida Console,Monaco,monospace;font-family:var(--font-monospace);font-size:1.125rem;grid-template-areas:"heading search nav theme-toggle";grid-template-columns:auto auto 1fr auto;padding:.75rem}.logo{color:var(--fg0);display:flex;font-weight:700;grid-area:heading}.logo:hover .logo__cursor{animation:blink 1s infinite;opacity:1}.logo__chevron,.logo__cursor{margin-left:.5rem}.logo__cursor{opacity:0}.logo__text{display:none}@media (min-width:768px){.logo__text{display:block}}.search{display:flex;grid-area:search;margin:0 1rem}#search__text{background:var(--bg2);border:1px solid var(--bg2);border-radius:.2rem;caret-color:var(--fg);color:var(--fg);outline:none;padding:0 .5rem;width:100%}#search__text:hover{border-color:var(--bg3)}#search__text:focus{border-color:var(--bg4)}#search__text::-moz-placeholder{color:var(--fg3)}#search__text::placeholder{color:var(--fg3)}#search__text[type=search]::-webkit-search-cancel-button{-webkit-appearance:none;appearance:none}#search__suggestions{background:var(--bg);border-radius:.2rem;box-shadow:0 .5rem 1rem var(--bg1);font-family:Roboto Slab,Georgia,serif;font-family:var(--font-serif);left:0;margin-top:2rem;position:absolute;width:95vw;z-index:1000}@media (min-width:768px){.search{position:relative}#search__suggestions{width:60vw}}.search__suggestions--hidden{display:none}.search__suggestion-item{border-bottom:1px dashed var(--bg2);display:grid;grid-template-columns:1fr 2fr}.search__suggestion-item:focus,.search__suggestion-item:focus-visible,.search__suggestion-item:hover{background:var(--bg1);cursor:pointer;outline:none}.search__suggestion-item:last-child{border:none}.search__suggestion-description,.search__suggestion-title{margin:1rem 0;padding:0 1rem}.search__suggestion-title{font-weight:700}.search__suggestion-description{border-left:1px solid var(--bg2)}.search__no-results{padding:.75rem}.theme__toggle{align-items:center;background:none;border:none;color:var(--yellow1);cursor:pointer;display:flex;grid-area:theme-toggle;margin:0 1rem}.theme__toggle:hover{color:var(--yellow2)}.theme__toggle svg{height:28px;width:28px}nav#menu{align-items:center;display:flex;grid-area:nav;justify-content:flex-end}nav#menu .menu__item{color:var(--fg)}nav#menu .menu__item:hover{color:var(--fg3);cursor:pointer}nav#menu ul{list-style:none;margin:0;padding:0}nav#menu ul.menu--horizontal{align-items:center;display:none}nav#menu ul.menu--horizontal li{display:inline-block;margin:0 .75rem}@media (min-width:768px){nav#menu ul.menu--horizontal{display:flex}}nav#menu ul.menu--vertical{background:var(--fg0);bottom:0;margin:0;padding:3rem;position:fixed;right:0;top:0;transform:translate(100%);transition:transform .5s cubic-bezier(.9,0,.1,1);width:50%;z-index:10}nav#menu ul.menu--vertical .menu__item{color:var(--bg1)}nav#menu ul.menu--vertical .menu__item:hover{color:var(--bg4)}nav#menu .menu__burger{display:flex;height:24px;width:24px}nav#menu .menu__burger>*{position:absolute}nav#menu .menu__burger svg{height:inherit;width:inherit;z-index:20}nav#menu .menu__burger svg line{transition-duration:.5s;transition-property:stroke,opacity,transform;transition-timing-function:cubic-bezier(.9,0,.1,1)}nav#menu .menu__burger svg line:first-of-type{transform-origin:center 6px}nav#menu .menu__burger svg line:nth-of-type(2){transform-origin:center 12px}nav#menu .menu__burger svg line:nth-of-type(3){transform-origin:center 18px}nav#menu .menu__burger input{height:inherit;opacity:0;width:inherit;z-index:30}nav#menu .menu__burger input:checked~ul.menu--vertical{transform:none}nav#menu .menu__burger input:checked~svg{stroke:var(--bg1)}nav#menu .menu__burger input:checked~svg line:first-of-type{transform:translateY(6px) rotate(45deg)}nav#menu .menu__burger input:checked~svg line:nth-of-type(2){opacity:0;transform:scale(.2)}nav#menu .menu__burger input:checked~svg line:nth-of-type(3){transform:translateY(-6px) rotate(-45deg)}@media (min-width:768px){nav#menu .menu__burger{display:none}}.sidebar{font-family:Fira Code,Lucida Console,Monaco,monospace;font-family:var(--font-monospace);margin-left:auto;margin-right:auto;max-width:350px;padding-left:2.5rem}.sidebar hr{margin:1.5rem auto}.sidebar svg{fill:var(--fg)}.sidebar__heading{font-size:1.3rem}aside.toc a{color:var(--aqua2);color:var(--primary-alt)}aside.toc a:hover{color:var(--aqua1);color:var(--primary)}aside.toc ul{list-style:none;margin:0;padding:0}aside.toc ul ul{font-size:.9rem;margin-left:.5rem}aside.toc ul li{line-height:1.1}aside.toc ul li a{display:block;padding:.2rem 0}.jr-basics__image{background:var(--bg1);border:2px solid var(--bg2)}.jr-basics__summary{color:var(--fg3);font-family:Roboto Slab,Georgia,serif;font-family:var(--font-serif);margin:.75rem 0}.jr-basics__profile a:hover{color:var(--fg3)}.jr-basics__profile a:hover svg{fill:var(--fg3)}.content-section,.post{border-bottom:2px dotted var(--bg1);padding:2rem 0}.post figure,.post img:not(figure img),.post video:not(figure video){box-sizing:border-box;margin:.5rem 0}.post-content__read-more,.post-header{font-family:Fira Code,Lucida Console,Monaco,monospace;font-family:var(--font-monospace)}.post-content{margin:1.3rem 0}.post-content__read-more{margin-top:1.3rem}.post-content a,.post-content__read-more,.post-header a{color:var(--aqua2);color:var(--primary-alt)}.post-content a:hover,.post-header a:hover{color:var(--aqua1);color:var(--primary)}.post-tags{align-items:center;display:flex;flex-wrap:wrap;gap:.9rem;margin:1rem 0}.post-tag{font-size:.9rem;line-height:1}.post-tag:before{content:"#"}.post-heading__anchor{display:none}h1:hover .post-heading__anchor,h2:hover .post-heading__anchor,h3:hover .post-heading__anchor,h4:hover .post-heading__anchor,h5:hover .post-heading__anchor{display:inline-block}.jr__item-meta{flex-direction:column}.jr-basics__image,.jr-basics__item,.jr-basics__profile-icon,.jr-basics__profile-item,.jr__item-meta{align-items:center;display:flex}.jr-basics__name,.jr-projects__roles,.jr-work__position{font-size:1.125rem;font-weight:700}.jr-basics__item{flex-direction:column;text-align:center}.jr-basics__item hr{margin:1.5rem auto}.jr-basics__image{border-radius:50%;height:250px;justify-content:center;overflow:hidden;width:250px}.jr-basics__label,.jr-basics__name,.jr-basics__summary{margin-top:.75rem}.jr-basics__profile svg{height:24px;width:24px}.jr-basics__profile,.jr-basics__profile-item{display:flex}.jr-basics__profile-item{display:flex;padding:.2rem}.jr-basics__profile--row{flex-wrap:wrap;justify-content:space-evenly}.jr-basics__profile-icon{padding:0 .75rem}.jr__item-meta{align-items:start;flex-flow:column;font-family:Fira Code,Lucida Console,Monaco,monospace;font-family:var(--font-monospace)}@media (min-width:768px){.jr__item-meta{align-items:center;flex-flow:row wrap}.jr-work__location,.jr__date-range{flex-grow:1;text-align:right}}#cookie-consent{animation:fadeIn .75s;background:var(--fg0);border-radius:.2rem;bottom:1rem;box-shadow:0 -.5rem 1rem var(--bg1);color:var(--bg1);font-family:Fira Code,Lucida Console,Monaco,monospace;font-family:var(--font-monospace);left:1rem;padding:1rem;position:fixed;right:1rem;z-index:2000}@media (min-width:768px){#cookie-consent{padding:2.5rem}}#cookie-consent button{background:none;border:none;color:var(--aqua1);color:var(--primary);font-size:1.125rem;margin:0 1rem;white-space:nowrap}#cookie-consent button:hover{color:var(--aqua2);color:var(--primary-alt);cursor:pointer}.cookie-consent--hidden{display:none}.cli-prompt{display:flex;justify-content:center}.cli-prompt__cursor{animation:blink 1s infinite}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}.social-share{align-items:center;border-top:2px dotted var(--bg1);display:flex;flex-wrap:wrap;gap:.9rem;margin:3rem 0;padding-top:3rem}.social-share svg{fill:var(--fg);height:24px;width:24px}.social-share svg.icon-tabler{fill:none;stroke:var(--fg)}.social-share__item{background:var(--bg1);display:flex;padding:.5rem}</style><link rel=preload href="/css/non-critical.713869c4c9bcaee5df59301fd32a5d831bdcc701104d142e54e1da442b7b0ed98ab0037e053dce4e3c73ef9b86b2e4d1cecf4444414cce6dc9e979de548736e0.css" as=style onload='this.onload=null,this.rel="stylesheet"' integrity="sha512-cThpxMm8ruXfWTAf0ypdgxvcxwEQTRQuVOHaRCt7DtmKsAN+BT3OTjxz75uGsuTRzs9EREFMzm3J6XneVIc24A=="><link id=prism-dark rel=preload href=/prism-themes/prism-gruvbox-dark.min.54aecc64074623a4f9898544dcbdab9e804f1560ef0b38f4cf8e10fcaaf72264e798cb407c601aca6ecd833ec4eb93d66535581f18d45ba202cf848b70dbc332.css as=style onload='this.onload=null,this.rel="stylesheet"' integrity="sha512-VK7MZAdGI6T5iYVE3L2rnoBPFWDvCzj0z44Q/Kr3ImTnmMtAfGAaym7Ngz7E65PWZTVYHxjUW6ICz4SLcNvDMg=="><link id=prism-light rel=preload href=/prism-themes/prism-gruvbox-light.min.42a221741efe997fcc94187c39d63c555560678789ac9ca856c74a5f0ddb2aa6c50d38b2ffbecc7a99038cbbd2efa99746e862267f781c559e0cfec10b88a5fc.css as=style onload='this.onload=null,this.rel="stylesheet"' integrity="sha512-QqIhdB7+mX/MlBh8OdY8VVVgZ4eJrJyoVsdKXw3bKqbFDTiy/77MepkDjLvS76mXRuhiJn94HFWeDP7BC4il/A==" disabled><noscript><link rel=stylesheet href=/prism-themes/prism-gruvbox-dark.min.54aecc64074623a4f9898544dcbdab9e804f1560ef0b38f4cf8e10fcaaf72264e798cb407c601aca6ecd833ec4eb93d66535581f18d45ba202cf848b70dbc332.css integrity="sha512-VK7MZAdGI6T5iYVE3L2rnoBPFWDvCzj0z44Q/Kr3ImTnmMtAfGAaym7Ngz7E65PWZTVYHxjUW6ICz4SLcNvDMg=="><link rel=stylesheet href="/css/non-critical.713869c4c9bcaee5df59301fd32a5d831bdcc701104d142e54e1da442b7b0ed98ab0037e053dce4e3c73ef9b86b2e4d1cecf4444414cce6dc9e979de548736e0.css" integrity="sha512-cThpxMm8ruXfWTAf0ypdgxvcxwEQTRQuVOHaRCt7DtmKsAN+BT3OTjxz75uGsuTRzs9EREFMzm3J6XneVIc24A=="></noscript><script>(()=>{function n(){if(localStorage&&localStorage.getItem("theme"))return localStorage.getItem("theme");if(window.matchMedia)return window.matchMedia("(prefers-color-scheme: light)").matches?"light":"dark"}function e(e){document.documentElement.setAttribute("data-theme",e);let t=document.getElementById("prism-dark"),n=document.getElementById("prism-light");t.toggleAttribute("disabled",e==="light"),n.toggleAttribute("disabled",e==="dark"),localStorage.setItem("theme",e)}var t=n();t&&e(t);function s(t){let n=t.currentTarget.classList.contains("light--hidden")?"light":"dark";e(n)}document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".theme__toggle").forEach(e=>{e.addEventListener("click",s)})})})()</script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta name=msapplication-TileColor content="#282828"><meta name=theme-color content="#282828"></head><body><div class=layout><header><a class=logo href=/><div class=logo__text>schnerring.net</div><div class=logo__chevron>></div><div class=logo__cursor>█</div></a><div class=search><input id=search__text type=search placeholder=Search... aria-label=Search autocomplete=off><div id=search__suggestions class=search__suggestions--hidden></div></div><nav id=menu><ul class=menu--horizontal><li class=menu__item><a href=/blog>Blog</a></li><li class=menu__item><a href=/projects>Projects</a></li><li class=menu__item><a href=/about>About</a></li><li class=menu__item><a href=/stats>Stats</a></li></ul><div class=menu__burger><input class=menu__item type=checkbox aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 6h16"/><path d="M4 12h16"/><path d="M4 18h16"/></svg><ul class=menu--vertical><li><a class=menu__item href=/blog>Blog</a></li><li><a class=menu__item href=/projects>Projects</a></li><li><a class=menu__item href=/about>About</a></li><li><a class=menu__item href=/stats>Stats</a></li></ul></div></nav><button class="theme__toggle light--hidden" aria-label="Toggle light mode"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-4 0a4 4 0 108 0 4 4 0 10-8 0"/><path d="M3 12h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7-.7.7m0 11.4.7.7m-12.1-.7-.7.7"/></svg></button>
<button class="theme__toggle dark--hidden" aria-label="Toggle dark mode"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c.132.0.263.0.393.0a7.5 7.5.0 007.92 12.446A9 9 0 1112 2.992z"/></svg></button></header><main><div class=content><article class=post><div class=post-header><h1>Create a Hugo Website with GitHub Pages, GitHub Actions, and Cloudflare</h1><div class=post-meta><span>2021-03-19</span><span> (updated: 2022-01-16)</span><div class=post-tags><a class=post-tag href=https://schnerring.net/tags/hugo>hugo</a><a class=post-tag href=https://schnerring.net/tags/cloudflare>cloudflare</a><a class=post-tag href=https://schnerring.net/tags/github-actions>github&#8209;actions</a><a class=post-tag href=https://schnerring.net/tags/github-pages>github&#8209;pages</a></div><picture><source type=image/webp srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cover_hu45cd04338d3ba344a2aaad4473857003_81916_300x0_resize_q90_h2_box.webp 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cover_hu45cd04338d3ba344a2aaad4473857003_81916_500x0_resize_q90_h2_box.webp 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cover_hu45cd04338d3ba344a2aaad4473857003_81916_700x0_resize_q90_h2_box.webp 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px"><img src=/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cover.jpg srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cover_hu45cd04338d3ba344a2aaad4473857003_81916_300x0_resize_q90_box.jpg 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cover_hu45cd04338d3ba344a2aaad4473857003_81916_500x0_resize_q90_box.jpg 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cover_hu45cd04338d3ba344a2aaad4473857003_81916_700x0_resize_q90_box.jpg 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px" alt width=1003 height=621></picture></div></div><div class=post-content><p>In this beginner guide, you&rsquo;ll create a Hugo website from scratch and publish the website on GitHub Pages. You&rsquo;ll configure Cloudflare&rsquo;s DNS and utilize its caching capabilities to optimize page speeds. Finally, implementing automated deployments with GitHub Pages will enable you to publish new content on your site easily.</p><h2 id=motivation>Motivation<a href=#motivation class=post-heading__anchor aria-hidden=true>#</a></h2><p>Over the last couple of years, I&rsquo;ve written documentation for private hobby projects, most of it in <a href=https://en.wikipedia.org/wiki/Markdown class=link--external target=_blank rel=noreferrer>Markdown</a> and managed with <a href=https://git-scm.com/ class=link--external target=_blank rel=noreferrer>Git</a>. It&rsquo;s all over the place, some parts quite elaborate, other stuff just bullet point lists.</p><p>I think some of it might be useful for others, so I started looking for ways to publish Markdown documentation and found <a href=https://gohugo.io/ class=link--external target=_blank rel=noreferrer>Hugo</a>. It&rsquo;s a simple to use, modern, and very popular static site generator that encourages the use of Markdown files. Perfect!</p><p>Having found Hugo, I started looking into how to best host static content. I&rsquo;ve been using <a href=https://github.com/ class=link--external target=_blank rel=noreferrer>GitHub</a> forever, so obviously I chose <a href=https://pages.github.com/ class=link--external target=_blank rel=noreferrer>GitHub Pages</a>. Accompanied by <a href=https://www.cloudflare.com/ class=link--external target=_blank rel=noreferrer>Cloudflare</a>&rsquo;s caching capabilities, a blazingly fast website is guaranteed.</p><p>The only thing missing was a way to automagically publish changes made to the Git repository on the website. This is where <a href=https://github.com/features/actions class=link--external target=_blank rel=noreferrer>GitHub Actions</a> come in.</p><p>With the technology figured out, in my very first guide, I&rsquo;ll show you step by step how I created this website in its first version. You can check out the code <a href=https://github.com/schnerring/schnerring.github.io/tree/v1.0.0 class=link--external target=_blank rel=noreferrer>on my GitHub</a> where I tagged the resulting commit with version <code>v1.0.0</code>.</p><h2 id=the-plan>The Plan<a href=#the-plan class=post-heading__anchor aria-hidden=true>#</a></h2><p>Here is an overview of what you&rsquo;ll do:</p><ol><li><a href=#step-1-prerequisites>Register for third-party services and install the required software</a></li><li><a href=#step-2-prepare-git>Prepare the Git repository</a></li><li><a href=#step-3-prepare-vs-code>Set up the development environment</a></li><li><a href=#step-4-enter-hugo>Create a Hugo site from scratch and run it locally</a></li><li><a href=#step-5-configure-cloudflare>Set up Cloudflare for a custom root (apex) domain</a></li><li><a href=#step-6-deploy-the-site-to-github-pages>Manually deploy the website to GitHub Pages</a></li><li><a href=#step-7-automate-deployments-with-github-actions>Deploy the website automatically to GitHub Pages with GitHub Actions</a></li></ol><p>I created this guide with Windows users in mind, but the workflow should be easily adaptable to other platforms. The steps are detailed and beginner-friendly, so if you&rsquo;re more experienced, you can skip through most parts of steps 1 to 3.</p><p>For this guide, I configured the <code>schnerring.net</code> domain and used <code>schnerring.github.io</code> as the GitHub Pages site. In the instructions, you&rsquo;ll need to replace these accordingly.</p><h2 id=step-1-prerequisites>Step #1: Prerequisites<a href=#step-1-prerequisites class=post-heading__anchor aria-hidden=true>#</a></h2><p>First, you&rsquo;ll need to register for a couple of services and install some software. Everything mentioned is free, except registering a custom domain name. I&rsquo;m not affiliated with any of the products I recommend in this guide.</p><h3 id=sign-up-at-third-party-services>Sign Up at Third-Party Services<a href=#sign-up-at-third-party-services class=post-heading__anchor aria-hidden=true>#</a></h3><ul><li>Register a domain name with your registrar — I&rsquo;m a very happy <a href=https://www.namecheap.com/ class=link--external target=_blank rel=noreferrer>Namecheap</a> customer</li><li>Sign up at <a href=https://www.cloudflare.com/ class=link--external target=_blank rel=noreferrer>Cloudflare</a></li><li>Sign up at <a href=https://github.com/ class=link--external target=_blank rel=noreferrer>GitHub</a></li></ul><h3 id=install-software-for-development>Install Software for Development<a href=#install-software-for-development class=post-heading__anchor aria-hidden=true>#</a></h3><p>Install the following programs for local development on our workstation:</p><ul><li><a href=https://gohugo.io/getting-started/installing/ class=link--external target=_blank rel=noreferrer>Hugo</a> — make sure to install <code>hugo-extended</code> to be able to use themes that utilize Sass/SCSS</li><li><a href=https://git-scm.com/download/win class=link--external target=_blank rel=noreferrer>Git for Windows</a> — source control management and shell</li><li><a href=https://code.visualstudio.com/Download class=link--external target=_blank rel=noreferrer>Visual Studio Code</a> — editor for coding</li><li><a href=https://www.google.com/chrome/index.html class=link--external target=_blank rel=noreferrer>Google Chrome</a> — web browser for debugging</li></ul><p>I used the <strong>Git Bash</strong> terminal to create the instructions for this guide. It&rsquo;s bundled with Git for Windows and provides UNIX-like commands like <code>rm</code>, <code>touch</code>, and more.</p><h2 id=step-2-prepare-git>Step #2: Prepare Git<a href=#step-2-prepare-git class=post-heading__anchor aria-hidden=true>#</a></h2><h3 id=create-a-github-repository>Create a GitHub Repository<a href=#create-a-github-repository class=post-heading__anchor aria-hidden=true>#</a></h3><p>Sign in to your GitHub account and create a new repository. To create a <em>user</em> type website with GitHub Pages, name the repository <code>schnerring.github.io</code>.</p><p>If you want to know more about GitHub Page types, you can find further information <a href=https://docs.github.com/en/free-pro-team@latest/github/working-with-github-pages/about-github-pages#types-of-github-pages-sites class=link--external target=_blank rel=noreferrer>in the GitHub Docs</a>.</p><p>Make sure to initialize the repository with a <code>README</code> and a <code>LICENSE</code> file. For this project, I chose the <strong>MIT license</strong>.</p><h3 id=clone-the-newly-created-repository-and-open-it-in-vs-code>Clone the Newly Created Repository and Open It in VS Code<a href=#clone-the-newly-created-repository-and-open-it-in-vs-code class=post-heading__anchor aria-hidden=true>#</a></h3><p>If you haven&rsquo;t already, <a href=https://docs.github.com/en/github-ae@latest/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent class=link--external target=_blank rel=noreferrer>configure an SSH key</a> to use with GitHub. You&rsquo;re now ready to clone the GitHub repository to your workstation. Open a Git Bash terminal and run the following commands:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git clone git@github.com:schnerring/schnerring.github.io.git
</span></span><span style=display:flex><span>cd schnerring.github.io
</span></span><span style=display:flex><span>code .
</span></span></code></pre></div><h2 id=step-3-prepare-vs-code>Step #3: Prepare VS Code<a href=#step-3-prepare-vs-code class=post-heading__anchor aria-hidden=true>#</a></h2><p>To make it easier to write clean and consistent code, install the following extensions:</p><p><strong><a href="https://marketplace.visualstudio.com/items?itemName=EditorConfig.EditorConfig" class=link--external target=_blank rel=noreferrer>EditorConfig</a></strong></p><blockquote><p>EditorConfig helps maintain consistent coding styles for multiple developers working on the same project across various editors and IDEs.</p></blockquote><p><strong><a href="https://marketplace.visualstudio.com/items?itemName=DavidAnson.vscode-markdownlint" class=link--external target=_blank rel=noreferrer>markdownlint</a></strong></p><blockquote><p>markdownlint is a static analysis tool for Node.js with a library of rules to enforce standards and consistency for Markdown files</p></blockquote><p><strong><a href="https://marketplace.visualstudio.com/items?itemName=timonwong.shellcheck" class=link--external target=_blank rel=noreferrer>shellcheck</a></strong></p><blockquote><p>ShellCheck is a GPLv3 tool that gives warnings and suggestions for bash/sh shell scripts</p></blockquote><h3 id=add-the-vscodeextensionsjson-file>Add the <code>.vscode/extensions.json</code> File<a href=#add-the-vscodeextensionsjson-file class=post-heading__anchor aria-hidden=true>#</a></h3><p><a href=https://code.visualstudio.com/docs/editor/extension-gallery#_workspace-recommended-extensions class=link--external target=_blank rel=noreferrer>Workspace recommended extensions</a> for VS Code make it easy to share a set of extensions easily across development environments. When you open a repository folder in VS Code and some recommended extensions are missing, you&rsquo;ll be notified, and just one click away from installing them.</p><p>Here&rsquo;s what the file looks like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;recommendations&#34;</span>: [
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;editorconfig.editorconfig&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;davidanson.vscode-markdownlint&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;omartawfik.github-actions-vscode&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;timonwong.shellcheck&#34;</span>
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=add-the-vscodelaunchjson-file>Add the <code>.vscode/launch.json</code> File<a href=#add-the-vscodelaunchjson-file class=post-heading__anchor aria-hidden=true>#</a></h3><p>When running <code>hugo server</code> locally during development, it&rsquo;s nice to be able to open <code>http://localhost:1313</code> in Chrome from within VS Code by just hitting the <code>F5</code> key. For this, you need to add a <em>launch configuration</em>. VS Code stores launch configurations in the <code>launch.json</code> file located in the <code>.vscode/</code> folder.</p><p>For Windows, the configuration looks like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Use IntelliSense to learn about possible attributes.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// Hover to view descriptions of existing attributes.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;0.2.0&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;configurations&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;pwa-chrome&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;request&#34;</span>: <span style=color:#e6db74>&#34;launch&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Launch Chrome against localhost&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;url&#34;</span>: <span style=color:#e6db74>&#34;http://localhost:1313&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;webRoot&#34;</span>: <span style=color:#e6db74>&#34;${workspaceFolder}&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Check out the official documentation to learn more about <a href=https://code.visualstudio.com/Docs/editor/debugging class=link--external target=_blank rel=noreferrer>debugging in VS Code</a>.</p><h3 id=add-the-editorconfig-configuration>Add the EditorConfig Configuration<a href=#add-the-editorconfig-configuration class=post-heading__anchor aria-hidden=true>#</a></h3><p>Add the <code>.editorconfig</code> file to the root folder of the repository:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span># top-most EditorConfig file
</span></span><span style=display:flex><span>root = true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># every file
</span></span><span style=display:flex><span>[*]
</span></span><span style=display:flex><span>charset = utf-8
</span></span><span style=display:flex><span>indent_size = 2
</span></span><span style=display:flex><span>indent_style = space
</span></span><span style=display:flex><span>insert_final_newline = true
</span></span><span style=display:flex><span>trim_trailing_whitespace = true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># Markdown files
</span></span><span style=display:flex><span>[*.md]
</span></span><span style=display:flex><span>trim_trailing_whitespace = false
</span></span></code></pre></div><p><a href=https://editorconfig.org/ class=link--external target=_blank rel=noreferrer>Check out EditorConfig</a> if you want to learn more, it&rsquo;s awesome!</p><h3 id=add-the-gitignore-file>Add the <code>.gitignore</code> File<a href=#add-the-gitignore-file class=post-heading__anchor aria-hidden=true>#</a></h3><p>To prevent cluttering of the repository with files generated by VS Code, add a <code>.gitignore</code> file to the root of the repository. To generate the <code>.gitignore</code> file, I like to use <a href=https://www.toptal.com/developers/gitignore class=link--external target=_blank rel=noreferrer>gitignore.io</a>. Hugo adds a <code>debug.log</code> file from time to time which I manually add, as well.</p><pre tabindex=0><code class=language-ignore data-lang=ignore>debug.log

# Created by https://www.toptal.com/developers/gitignore/api/hugo,vscode
# Edit at https://www.toptal.com/developers/gitignore?templates=hugo,vscode

### Hugo ###
# Generated files by hugo
/public/
/resources/_gen/
hugo_stats.json

# Executable may be added to repository
hugo.exe
hugo.darwin
hugo.linux

### vscode ###
.vscode/*
!.vscode/settings.json
!.vscode/tasks.json
!.vscode/launch.json
!.vscode/extensions.json
*.code-workspace

# End of https://www.toptal.com/developers/gitignore/api/hugo,vscode
</code></pre><h3 id=push-development-environment-settings-to-github>Push Development Environment Settings to GitHub<a href=#push-development-environment-settings-to-github class=post-heading__anchor aria-hidden=true>#</a></h3><p>The folder structure now looks like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>.vscode/
</span></span><span style=display:flex><span>├─ extensions.json
</span></span><span style=display:flex><span>├─ launch.json
</span></span><span style=display:flex><span>.editorconfig
</span></span><span style=display:flex><span>.gitignore
</span></span><span style=display:flex><span>LICENSE
</span></span><span style=display:flex><span>README.md
</span></span></code></pre></div><p>Push the changes to GitHub:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git add --all
</span></span><span style=display:flex><span>git commit --message<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Add vscode launch.json / extensions.json, .editorconfig, .gitignore&#34;</span>
</span></span><span style=display:flex><span>git push
</span></span></code></pre></div><h2 id=step-4-enter-hugo>Step #4: Enter Hugo<a href=#step-4-enter-hugo class=post-heading__anchor aria-hidden=true>#</a></h2><p><a href=https://gohugo.io/getting-started/quick-start/ class=link--external target=_blank rel=noreferrer>Only a few steps</a> are required to create a functional Hugo site.</p><h3 id=create-a-new-site>Create a New Site<a href=#create-a-new-site class=post-heading__anchor aria-hidden=true>#</a></h3><p>To create a Hugo site in your current working folder, use the <a href=https://gohugo.io/commands/ class=link--external target=_blank rel=noreferrer>Hugo CLI</a>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>hugo new site . --force
</span></span></code></pre></div><p>With <code>--force</code>, Hugo won&rsquo;t complain about the folder containing files.</p><h3 id=add-a-theme>Add a Theme<a href=#add-a-theme class=post-heading__anchor aria-hidden=true>#</a></h3><p>To get started quickly, add the <a href=https://themes.gohugo.io/hugo-theme-hello-friend class=link--external target=_blank rel=noreferrer>Hello Friend theme</a> as a <a href=https://git-scm.com/book/en/v2/Git-Tools-Submodules class=link--external target=_blank rel=noreferrer>Git Submodule</a>. Check out <a href=https://themes.gohugo.io/ class=link--external target=_blank rel=noreferrer>themes.gohugo.io</a> for more themes.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git submodule add https://github.com/panr/hugo-theme-hello-friend.git themes/hello-friend
</span></span></code></pre></div><h3 id=update-the-hugo-configuration>Update the Hugo Configuration<a href=#update-the-hugo-configuration class=post-heading__anchor aria-hidden=true>#</a></h3><p>The Hello Friend theme requires minimal configuration steps to work. As a baseline, use the sample <a href=https://github.com/rhazdon/hugo-theme-hello-friend-ng#how-to-configure class=link--external target=_blank rel=noreferrer>provided in the themes&rsquo; README</a> and make some straightforward changes to it.</p><p>The resulting <code>config.toml</code> looks like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=display:flex><span><span style=color:#a6e22e>baseURL</span> = <span style=color:#e6db74>&#34;https://schnerring.net&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>languageCode</span> = <span style=color:#e6db74>&#34;en-us&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>theme</span> = <span style=color:#e6db74>&#34;hello-friend&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>paginate</span> = <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ignoreFiles</span> = [ <span style=color:#e6db74>&#34;LICENSE$&#34;</span> ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[<span style=color:#a6e22e>params</span>]
</span></span><span style=display:flex><span>  <span style=color:#75715e># dir name of your blog content (default is `content/posts`).</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># the list of set content will show up on your index page (baseurl).</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>#contentTypeName = &#34;posts&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># &#34;light&#34; or &#34;dark&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>defaultTheme</span> = <span style=color:#e6db74>&#34;dark&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># if you set this to 0, only submenu trigger will be visible</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>showMenuItems</span> = <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># Show reading time in minutes for posts</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>showReadingTime</span> = <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># Show table of contents at the top of your posts (defaults to false)</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># Alternatively, add this param to post front matter for specific posts</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># toc = true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># Show full page content in RSS feed items</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>#(default is Description or Summary metadata in the front matter)</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># rssFullText = true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[<span style=color:#a6e22e>languages</span>]
</span></span><span style=display:flex><span>  [<span style=color:#a6e22e>languages</span>.<span style=color:#a6e22e>en</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>title</span> = <span style=color:#e6db74>&#34;Michael Schnerring&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>subtitle</span> = <span style=color:#e6db74>&#34;Coder and Computer Enthusiast&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>keywords</span> = <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>description</span> = <span style=color:#e6db74>&#34;Michael Schnerring is a coder and computer enthusiast.&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>copyright</span> = <span style=color:#e6db74>&#34;&lt;p&gt;Copyright © 2020 Michael Schnerring&lt;/p&gt;&lt;p xmlns:dct=&#39;http://purl.org/dc/terms/&#39; xmlns:cc=&#39;http://creativecommons.org/ns#&#39; class=&#39;license-text&#39;&gt;&lt;a rel=&#39;cc:attributionURL&#39; property=&#39;dct:title&#39; href=&#39;https://github.com/schnerring/schnerring.github.io/tree/main/content&#39;&gt;Content&lt;/a&gt; licensed under &lt;a rel=&#39;license&#39; href=&#39;https://creativecommons.org/licenses/by/4.0&#39;&gt;CC BY 4.0&lt;/a&gt;&lt;/p&gt;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>menuMore</span> = <span style=color:#e6db74>&#34;Show more&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>writtenBy</span> = <span style=color:#e6db74>&#34;Written by&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>readMore</span> = <span style=color:#e6db74>&#34;Read more&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>readOtherPosts</span> = <span style=color:#e6db74>&#34;Read other posts&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>newerPosts</span> = <span style=color:#e6db74>&#34;Newer posts&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>olderPosts</span> = <span style=color:#e6db74>&#34;Older posts&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>minuteReadingTime</span> = <span style=color:#e6db74>&#34;min read&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>dateFormatSingle</span> = <span style=color:#e6db74>&#34;2006-01-02&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>dateFormatList</span> = <span style=color:#e6db74>&#34;2006-01-02&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># leave empty to disable, enter display text to enable</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#lastModDisplay = &#34;modified&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [<span style=color:#a6e22e>languages</span>.<span style=color:#a6e22e>en</span>.<span style=color:#a6e22e>params</span>.<span style=color:#a6e22e>logo</span>]
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>logoText</span> = <span style=color:#e6db74>&#34;schnerring.net&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>logoHomeLink</span> = <span style=color:#e6db74>&#34;/&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># or</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># path = &#34;/img/your-example-logo.svg&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># alt = &#34;Your example logo alt text&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [<span style=color:#a6e22e>languages</span>.<span style=color:#a6e22e>en</span>.<span style=color:#a6e22e>menu</span>]
</span></span><span style=display:flex><span>      [[<span style=color:#a6e22e>languages</span>.<span style=color:#a6e22e>en</span>.<span style=color:#a6e22e>menu</span>.<span style=color:#a6e22e>main</span>]]
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>identifier</span> = <span style=color:#e6db74>&#34;about&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>name</span> = <span style=color:#e6db74>&#34;About&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>url</span> = <span style=color:#e6db74>&#34;/about&#34;</span>
</span></span></code></pre></div><p>The themes&rsquo; GitHub repository <a href=https://github.com/rhazdon/hugo-theme-hello-friend-ng/blob/master/exampleSite/config.toml class=link--external target=_blank rel=noreferrer>features another <code>config.toml</code> example</a>. You can read more about how to configure Hugo <a href=https://gohugo.io/getting-started/configuration/ class=link--external target=_blank rel=noreferrer>in the official documentation</a>.</p><h3 id=add-some-content>Add Some Content<a href=#add-some-content class=post-heading__anchor aria-hidden=true>#</a></h3><p>With the help of the Hugo CLI, add an about page and the first blog post:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>hugo new about.md
</span></span><span style=display:flex><span>hugo new posts/hello-world.md
</span></span></code></pre></div><h4 id=aboutmd>about.md<a href=#aboutmd class=post-heading__anchor aria-hidden=true>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>---
</span></span><span style=display:flex><span>title: &#34;About&#34;
</span></span><span style=display:flex><span>draft: false
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>I code by day and toy around with computers by night...
</span></span></code></pre></div><h4 id=postshello-worldmd>posts/hello-world.md<a href=#postshello-worldmd class=post-heading__anchor aria-hidden=true>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>---
</span></span><span style=display:flex><span>title: &#34;Hello World&#34;
</span></span><span style=display:flex><span>description: &#34;The first post of this blog&#34;
</span></span><span style=display:flex><span>date: 2021-03-14T15:00:21+01:00
</span></span><span style=display:flex><span>draft: false
</span></span><span style=display:flex><span>tags:
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>-</span> &#34;csharp&#34;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>-</span> &#34;hello world&#34;
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>I&#39;m a .NET developer by trade, so let&#39;s say hello in C#!
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>```csharp
</span></span></span><span style=display:flex><span><span style=color:#e6db74></span><span style=color:#66d9ef>using</span> System;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Program</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> Main(<span style=color:#66d9ef>string</span>[] args)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        Console.WriteLine(<span style=color:#e6db74>&#34;Hello, world!&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#e6db74>```</span>
</span></span></code></pre></div><p>Note the post&rsquo;s default status <code>draft: true</code>, so newly created content has to be published manually. You can read more about it <a href=https://gohugo.io/getting-started/usage/#draft-future-and-expired-content class=link--external target=_blank rel=noreferrer>in the official documentation</a>. Make sure to set this to <code>false</code> before deployment or the post won&rsquo;t be displayed.</p><h3 id=run-the-site-locally>Run the Site Locally<a href=#run-the-site-locally class=post-heading__anchor aria-hidden=true>#</a></h3><p>To finally test the changes locally, run the following in a Git Bash terminal. The <code>--buildDrafts</code> (or <code>-D</code>) option enables you to also view content that has set <code>draft: true</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>hugo server --buildDrafts
</span></span></code></pre></div><p>Hit the <code>F5</code> button in VS Code to open the page in Chrome.</p><h3 id=push-the-changes>Push the Changes<a href=#push-the-changes class=post-heading__anchor aria-hidden=true>#</a></h3><p>Git ignores empty folders, so if you push the current changes and re-clone the repository, the Hugo folder structure would be partially gone. A common practice is to add empty <code>.gitkeep</code> marker files to empty folders to prevent this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>touch <span style=color:#f92672>{</span>data,layouts,static<span style=color:#f92672>}</span>/.gitkeep
</span></span></code></pre></div><p>Your folder structure should look like this, excluding <code>resources</code> or <code>public</code> folders, since those are <code>.gitignore</code>d:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>.vscode/
</span></span><span style=display:flex><span>├─ extensions.json
</span></span><span style=display:flex><span>├─ launch.json
</span></span><span style=display:flex><span>archetypes/
</span></span><span style=display:flex><span>├─ default.md
</span></span><span style=display:flex><span>content/
</span></span><span style=display:flex><span>├─ posts/
</span></span><span style=display:flex><span>│  ├─ hello-world.md
</span></span><span style=display:flex><span>├─ about.md
</span></span><span style=display:flex><span>data/
</span></span><span style=display:flex><span>├─ .gitkeep
</span></span><span style=display:flex><span>layouts/
</span></span><span style=display:flex><span>├─ .gitkeep
</span></span><span style=display:flex><span>static/
</span></span><span style=display:flex><span>├─ .gitkeep
</span></span><span style=display:flex><span>themes/
</span></span><span style=display:flex><span>├─ hello-friend/    (submodule)
</span></span><span style=display:flex><span>.editorconfig
</span></span><span style=display:flex><span>.gitignore
</span></span><span style=display:flex><span>.gitmodules
</span></span><span style=display:flex><span>config.toml
</span></span><span style=display:flex><span>LICENSE
</span></span><span style=display:flex><span>README.md
</span></span></code></pre></div><p>Commit and push everything:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git add -A
</span></span><span style=display:flex><span>git commit -m <span style=color:#e6db74>&#34;Add Hugo site, hello-friend theme, about page and hello-world post&#34;</span>
</span></span><span style=display:flex><span>git push
</span></span></code></pre></div><h2 id=step-5-configure-cloudflare>Step #5: Configure Cloudflare<a href=#step-5-configure-cloudflare class=post-heading__anchor aria-hidden=true>#</a></h2><h3 id=add-the-site-to-cloudflare>Add the Site to Cloudflare<a href=#add-the-site-to-cloudflare class=post-heading__anchor aria-hidden=true>#</a></h3><ol><li>Sign in to your Cloudflare account</li><li>Click <strong>+ Add site</strong> in the navigation bar and add <code>schnerring.net</code></li><li>Select <strong>Free plan</strong></li><li>Navigate to the <strong>Overview</strong> page of the newly created site</li><li>Take note of Cloudflare&rsquo;s nameservers, in my case <em>carol.ns.cloudflare.com</em> and <em>cody.ns.cloudflare.com</em></li></ol><h3 id=change-the-nameservers-for-your-domain>Change the Nameservers for Your Domain<a href=#change-the-nameservers-for-your-domain class=post-heading__anchor aria-hidden=true>#</a></h3><p>Sign in to the administrator account of your domain registrar and change the nameservers. My Namecheap nameserver configuration for <code>schnerring.net</code> looks like this after adding the Cloudflare nameservers:</p><p><picture><source type=image/webp srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/namecheap-nameservers_hu8ef1168285bf5c7482414db3f0bfb5f4_6584_300x0_resize_q90_h2_box_3.webp 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/namecheap-nameservers_hu8ef1168285bf5c7482414db3f0bfb5f4_6584_500x0_resize_q90_h2_box_3.webp 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/namecheap-nameservers_hu8ef1168285bf5c7482414db3f0bfb5f4_6584_700x0_resize_q90_h2_box_3.webp 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px"><img src=/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/namecheap-nameservers.png srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/namecheap-nameservers_hu8ef1168285bf5c7482414db3f0bfb5f4_6584_300x0_resize_box_3.png 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/namecheap-nameservers_hu8ef1168285bf5c7482414db3f0bfb5f4_6584_500x0_resize_box_3.png 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/namecheap-nameservers_hu8ef1168285bf5c7482414db3f0bfb5f4_6584_700x0_resize_box_3.png 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px" alt="Namecheap Nameservers" loading=lazy width=738 height=127></picture></p><h3 id=add-the-cname-records>Add the CNAME Records<a href=#add-the-cname-records class=post-heading__anchor aria-hidden=true>#</a></h3><p>A <strong>CNAME</strong> record is used to map one domain name to another. Go to the DNS management at Cloudflare and add the following records to point your domain to GitHub Pages:</p><p><picture><source type=image/webp srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-dns-records_huc1464d4668e1be8a695263a979624279_5650_300x0_resize_q90_h2_box_3.webp 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-dns-records_huc1464d4668e1be8a695263a979624279_5650_500x0_resize_q90_h2_box_3.webp 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-dns-records_huc1464d4668e1be8a695263a979624279_5650_700x0_resize_q90_h2_box_3.webp 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px"><img src=/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-dns-records.png srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-dns-records_huc1464d4668e1be8a695263a979624279_5650_300x0_resize_box_3.png 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-dns-records_huc1464d4668e1be8a695263a979624279_5650_500x0_resize_box_3.png 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-dns-records_huc1464d4668e1be8a695263a979624279_5650_700x0_resize_box_3.png 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px" alt="Cloudflare DNS Records" loading=lazy width=844 height=70></picture></p><p>Make sure the “orange cloud” is enabled, so you can define rules and cache static content with Cloudflare.</p><h3 id=enable-_full_-ssltls-encryption-mode>Enable <em>Full</em> SSL/TLS Encryption Mode<a href=#enable-_full_-ssltls-encryption-mode class=post-heading__anchor aria-hidden=true>#</a></h3><p>Go to your site&rsquo;s <strong>SSL/TLS</strong> settings and set encryption to <strong>Full</strong>:</p><p><picture><source type=image/webp srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-encryption-settings_hud5b97256b275cdcaaa515db99b991fa3_6236_300x0_resize_q90_h2_box_3.webp 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-encryption-settings_hud5b97256b275cdcaaa515db99b991fa3_6236_434x0_resize_q90_h2_box_3.webp 434w" sizes="(max-width: 499px) 300px,434px"><img src=/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-encryption-settings.png srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-encryption-settings_hud5b97256b275cdcaaa515db99b991fa3_6236_300x0_resize_box_3.png 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-encryption-settings_hud5b97256b275cdcaaa515db99b991fa3_6236_434x0_resize_box_3.png 434w" sizes="(max-width: 499px) 300px,434px" alt="Cloudflare Encryption Settings" loading=lazy width=434 height=249></picture></p><h3 id=configure-the-browser-cache-ttl>Configure the Browser Cache TTL<a href=#configure-the-browser-cache-ttl class=post-heading__anchor aria-hidden=true>#</a></h3><p>Go to <strong>Cache</strong> → <strong>Configuration</strong> and choose <strong>2 months</strong> or higher, depending on how often you think your already published static content <em>changes</em>.</p><p><picture><source type=image/webp srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-browser-cache-ttl_hu307c1c0972ab6f537214acafe78f0178_12731_300x0_resize_q90_h2_box_3.webp 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-browser-cache-ttl_hu307c1c0972ab6f537214acafe78f0178_12731_500x0_resize_q90_h2_box_3.webp 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-browser-cache-ttl_hu307c1c0972ab6f537214acafe78f0178_12731_700x0_resize_q90_h2_box_3.webp 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px"><img src=/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-browser-cache-ttl.png srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-browser-cache-ttl_hu307c1c0972ab6f537214acafe78f0178_12731_300x0_resize_box_3.png 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-browser-cache-ttl_hu307c1c0972ab6f537214acafe78f0178_12731_500x0_resize_box_3.png 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-browser-cache-ttl_hu307c1c0972ab6f537214acafe78f0178_12731_700x0_resize_box_3.png 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px" alt="Cloudflare Browser Cache TTL" loading=lazy width=1044 height=245></picture></p><h3 id=add-page-rules>Add Page Rules<a href=#add-page-rules class=post-heading__anchor aria-hidden=true>#</a></h3><p>The Free Tier lets you create up to three page rules. Go to your site&rsquo;s <strong>Page Rules</strong> settings and click <strong>Create Page Rule</strong>.</p><h4 id=enforce-https>Enforce HTTPS<a href=#enforce-https class=post-heading__anchor aria-hidden=true>#</a></h4><p><picture><source type=image/webp srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-enforce-https_hu8cb8581c69d51e3829275dcf072d559e_10274_300x0_resize_q90_h2_box_3.webp 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-enforce-https_hu8cb8581c69d51e3829275dcf072d559e_10274_500x0_resize_q90_h2_box_3.webp 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-enforce-https_hu8cb8581c69d51e3829275dcf072d559e_10274_700x0_resize_q90_h2_box_3.webp 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px"><img src=/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-enforce-https.png srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-enforce-https_hu8cb8581c69d51e3829275dcf072d559e_10274_300x0_resize_box_3.png 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-enforce-https_hu8cb8581c69d51e3829275dcf072d559e_10274_500x0_resize_box_3.png 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-enforce-https_hu8cb8581c69d51e3829275dcf072d559e_10274_700x0_resize_box_3.png 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px" alt="Cloudflare Rule - Enforce HTTPS" loading=lazy width=770 height=327></picture></p><h4 id=add-forward-from-wwwschnerringnet-subdomain-to-schnerringnet-root-domain>Add Forward from <code>www.schnerring.net</code> Subdomain to <code>schnerring.net</code> Root Domain<a href=#add-forward-from-wwwschnerringnet-subdomain-to-schnerringnet-root-domain class=post-heading__anchor aria-hidden=true>#</a></h4><p>If you use a subdomain, skip this step.</p><p><picture><source type=image/webp srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-forward_hu5da2c3510ce4ec3abaf64e057700afc0_23399_300x0_resize_q90_h2_box_3.webp 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-forward_hu5da2c3510ce4ec3abaf64e057700afc0_23399_500x0_resize_q90_h2_box_3.webp 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-forward_hu5da2c3510ce4ec3abaf64e057700afc0_23399_700x0_resize_q90_h2_box_3.webp 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px"><img src=/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-forward.png srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-forward_hu5da2c3510ce4ec3abaf64e057700afc0_23399_300x0_resize_box_3.png 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-forward_hu5da2c3510ce4ec3abaf64e057700afc0_23399_500x0_resize_box_3.png 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-forward_hu5da2c3510ce4ec3abaf64e057700afc0_23399_700x0_resize_box_3.png 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px" alt="Cloudflare Rule - Forward" loading=lazy width=770 height=511></picture></p><h4 id=cache-all-static-content-to-speed-up-the-website>Cache All Static Content to Speed Up the Website<a href=#cache-all-static-content-to-speed-up-the-website class=post-heading__anchor aria-hidden=true>#</a></h4><p><picture><source type=image/webp srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-cache-everything_hu4c39d1bc6fbf7c88239c7a064ee51478_20611_300x0_resize_q90_h2_box_3.webp 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-cache-everything_hu4c39d1bc6fbf7c88239c7a064ee51478_20611_500x0_resize_q90_h2_box_3.webp 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-cache-everything_hu4c39d1bc6fbf7c88239c7a064ee51478_20611_700x0_resize_q90_h2_box_3.webp 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px"><img src=/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-cache-everything.png srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-cache-everything_hu4c39d1bc6fbf7c88239c7a064ee51478_20611_300x0_resize_box_3.png 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-cache-everything_hu4c39d1bc6fbf7c88239c7a064ee51478_20611_500x0_resize_box_3.png 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rule-cache-everything_hu4c39d1bc6fbf7c88239c7a064ee51478_20611_700x0_resize_box_3.png 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px" alt="Cloudflare Rule - Cache Everything" loading=lazy width=770 height=468></picture></p><h3 id=page-rules-overview>Page Rules Overview<a href=#page-rules-overview class=post-heading__anchor aria-hidden=true>#</a></h3><p><picture><source type=image/webp srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rules-overview_hu5ca34baa28c435e910bbfbad89a8ace3_9583_300x0_resize_q90_h2_box_3.webp 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rules-overview_hu5ca34baa28c435e910bbfbad89a8ace3_9583_500x0_resize_q90_h2_box_3.webp 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rules-overview_hu5ca34baa28c435e910bbfbad89a8ace3_9583_687x0_resize_q90_h2_box_3.webp 687w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,687px"><img src=/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rules-overview.png srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rules-overview_hu5ca34baa28c435e910bbfbad89a8ace3_9583_300x0_resize_box_3.png 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rules-overview_hu5ca34baa28c435e910bbfbad89a8ace3_9583_500x0_resize_box_3.png 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-page-rules-overview_hu5ca34baa28c435e910bbfbad89a8ace3_9583_687x0_resize_box_3.png 687w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,687px" alt="Cloudflare Page Rules Overview" loading=lazy width=687 height=191></picture></p><p>Note that as of May 2018 GitHub Pages supports HTTPS for custom domains out of the box. They utilize <a href=https://letsencrypt.org/ class=link--external target=_blank rel=noreferrer>Let&rsquo;s Encrypt</a> certificates which are better than the shared certificates you get with Cloudflare. But to issue Let&rsquo;s Encrypt certificates for both <code>www.schnerring.net</code> and <code>schnerring.net</code>, you&rsquo;d have to resort <a href=https://stackoverflow.com/a/58672792/1154965 class=link--external target=_blank rel=noreferrer>this, in my opinion hacky, solution</a>.</p><h2 id=step-6-deploy-the-site-to-github-pages>Step #6: Deploy the Site to GitHub Pages<a href=#step-6-deploy-the-site-to-github-pages class=post-heading__anchor aria-hidden=true>#</a></h2><p>You&rsquo;ll deploy the website to GitHub Pages on a separate, parallel <code>gh-pages</code> branch since published artifacts and source code are segregated this way. You can learn more about other options <a href=https://gohugo.io/hosting-and-deployment/hosting-on-github/ class=link--external target=_blank rel=noreferrer>in the official Hugo documentation</a>.</p><h3 id=initialize-gh-pages-branch>Initialize <code>gh-pages</code> branch<a href=#initialize-gh-pages-branch class=post-heading__anchor aria-hidden=true>#</a></h3><p>Create an <em>orphan</em> branch which has a <code>git init</code> like state with no history:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git checkout --orphan gh-pages
</span></span><span style=display:flex><span>git reset --hard
</span></span><span style=display:flex><span>git commit --allow-empty -m <span style=color:#e6db74>&#34;Init gh-pages branch&#34;</span>
</span></span><span style=display:flex><span>git push origin gh-pages
</span></span><span style=display:flex><span>git checkout main
</span></span></code></pre></div><h3 id=checkout-the-gh-pages-branch-in-public>Checkout the <code>gh-pages</code> Branch in <code>public/</code><a href=#checkout-the-gh-pages-branch-in-public class=post-heading__anchor aria-hidden=true>#</a></h3><p>To build the site, use the <code>hugo</code> command. The build artifacts will be placed in the <code>public/</code> folder, the contents of which need to be published on the <code>gh-pages</code> branch. To be able to checkout multiple branches, use <a href=https://git-scm.com/docs/git-worktree class=link--external target=_blank rel=noreferrer>Git&rsquo;s worktree feature</a>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git worktree add -B gh-pages public origin/gh-pages
</span></span></code></pre></div><h3 id=add-cname-file-to-static-folder>Add <code>CNAME</code> File to <code>static/</code> Folder<a href=#add-cname-file-to-static-folder class=post-heading__anchor aria-hidden=true>#</a></h3><p>Earlier, you configured Cloudflare to properly map <code>www.schnerring.net</code> and <code>schnerring.net</code> to <code>schnerring.github.io</code>&rsquo;s destination. However, you also need a redirect from <code>schnerring.github.io</code> to <code>schnerring.net</code>. You accomplish this by adding a <code>static/CNAME</code> file to the repo, containing your custom domain. When generating the site with <code>hugo</code>, the published site will contain the CNAME file at its root:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>echo <span style=color:#e6db74>&#34;schnerring.net&#34;</span> &gt; static/CNAME
</span></span><span style=display:flex><span>rm static/.gitkeep
</span></span><span style=display:flex><span>git add -A
</span></span><span style=display:flex><span>git commit -m <span style=color:#e6db74>&#34;Add CNAME file&#34;</span>
</span></span><span style=display:flex><span>git push
</span></span></code></pre></div><h3 id=build-the-hugo-site>Build the Hugo Site<a href=#build-the-hugo-site class=post-heading__anchor aria-hidden=true>#</a></h3><p>Make sure to set <code>draft: false</code> to publish the <code>hello-world.md</code> post. Push the change to GitHub by running <code>git commit -am "Publish hello-world.md" && git push</code>.</p><p>Then run <code>hugo</code>.</p><h3 id=push-the-changes-on-the-gh-pages-branch>Push the Changes on the <code>gh-pages</code> Branch<a href=#push-the-changes-on-the-gh-pages-branch class=post-heading__anchor aria-hidden=true>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cd public
</span></span><span style=display:flex><span>git add -A
</span></span><span style=display:flex><span>git commit -m <span style=color:#e6db74>&#34;Publish to gh-pages&#34;</span>
</span></span><span style=display:flex><span>git push
</span></span><span style=display:flex><span>cd ..
</span></span></code></pre></div><h3 id=set-gh-pages-as-publishing-branch>Set <code>gh-pages</code> as Publishing Branch<a href=#set-gh-pages-as-publishing-branch class=post-heading__anchor aria-hidden=true>#</a></h3><p>Navigate to your repository on GitHub</p><ol><li>Go to <strong>Settings</strong> → <strong>Pages</strong></li><li>Under <strong>Source</strong>, select <strong>Branch: <code>gh-pages</code></strong> and click <strong>Save</strong></li></ol><p>It should look like this:</p><p><picture><source type=image/webp srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/github-pages-settings_hu1bda46b97ad1d44350e2ec8e3cd82838_3864_300x0_resize_q90_h2_box_3.webp 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/github-pages-settings_hu1bda46b97ad1d44350e2ec8e3cd82838_3864_500x0_resize_q90_h2_box_3.webp 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/github-pages-settings_hu1bda46b97ad1d44350e2ec8e3cd82838_3864_534x0_resize_q90_h2_box_3.webp 534w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,534px"><img src=/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/github-pages-settings.png srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/github-pages-settings_hu1bda46b97ad1d44350e2ec8e3cd82838_3864_300x0_resize_box_3.png 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/github-pages-settings_hu1bda46b97ad1d44350e2ec8e3cd82838_3864_500x0_resize_box_3.png 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/github-pages-settings_hu1bda46b97ad1d44350e2ec8e3cd82838_3864_534x0_resize_box_3.png 534w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,534px" alt="GitHub Pages Settings" loading=lazy width=534 height=89></picture></p><p>Shortly after you perform these steps, your website should be available at <code>schnerring.net</code>.</p><h3 id=subsequent-deployments>Subsequent Deployments<a href=#subsequent-deployments class=post-heading__anchor aria-hidden=true>#</a></h3><p>For future deployments, several steps are required:</p><ol><li>Delete contents of <code>public/</code> folder, since <a href=https://gohugo.io/getting-started/usage/#deploy-your-website class=link--external target=_blank rel=noreferrer><code>hugo</code> does not remove generated files before building</a></li><li>Generate the site with <code>hugo</code></li><li>Push changes to the <code>gh-pages</code> branch</li><li>Purge Cloudflare cache</li></ol><p>This is an error-prone and tedious process if repeated frequently, so let&rsquo;s automate these steps with GitHub Pages next.</p><h2 id=step-7-automate-deployments-with-github-actions>Step #7: Automate Deployments with GitHub Actions<a href=#step-7-automate-deployments-with-github-actions class=post-heading__anchor aria-hidden=true>#</a></h2><h3 id=configure-github-actions>Configure GitHub Actions<a href=#configure-github-actions class=post-heading__anchor aria-hidden=true>#</a></h3><p><a href=https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions class=link--external target=_blank rel=noreferrer>GitHub Actions Workflows</a> are configured mostly through configuration files in the <code>.github/workflows</code> folder. This allows your configuration to be version controlled and flexible.</p><p>Add the following <code>.github/workflows/hugo.yml</code> file to the repository:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Hugo</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>branches</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># Allows to run workflow manually from Actions tab</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>workflow_dispatch</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>build</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Checkout repository and update Hugo themes</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v2</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>submodules</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>fetch-depth</span>: <span style=color:#ae81ff>0</span> <span style=color:#75715e># Fetch all history for .GitInfo and .Lastmod</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Install Hugo</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peaceiris/actions-hugo@v2</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>hugo-version</span>: <span style=color:#e6db74>&#34;0.81.0&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>extended</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build Hugo</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>hugo --minify</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Deploy to GitHub Pages</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peaceiris/actions-gh-pages@v3</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>github_token</span>: <span style=color:#ae81ff>${{ secrets.GITHUB_TOKEN }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>publish_dir</span>: <span style=color:#ae81ff>./public</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Purge Cloudflare Cache</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>CLOUDFLARE_ZONE_ID</span>: <span style=color:#ae81ff>${{ secrets.CLOUDFLARE_ZONE_ID }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>CLOUDFLARE_API_TOKEN</span>: <span style=color:#ae81ff>${{ secrets.CLOUDFLARE_API_TOKEN }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>GITHUB_TOKEN</span>: <span style=color:#ae81ff>${{ secrets.GITHUB_TOKEN }}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>run</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          chmod +x ./purge_cloudflare_cache.sh
</span></span></span><span style=display:flex><span><span style=color:#e6db74>          ./purge_cloudflare_cache.sh</span>          
</span></span></code></pre></div><p>Name the GitHub Actions Workflow <code>Hugo</code> which is triggered when pushed to the <code>main</code> branch. As OS, the <code>latest</code> version of <code>ubuntu</code> is used.</p><p>We only run one job, <code>build</code>, and perform the following steps:</p><ol><li>Checkout the repository and update Hugo themes</li><li>Install Hugo <code>extended</code> since the theme uses SCSS.</li><li>Build Hugo and <code>--minify</code></li><li>Deploy to GitHub Pages. The default deployment branch is <code>gh-pages</code>. Choose the <code>./public</code> folder to be published.</li><li>Purge the Cloudflare Cache by running the <code>./purge_cloudflare_cache.sh</code> script that you&rsquo;ll create in the next steps.</li></ol><p>The above is straight forward, thanks to the free Actions available at the <a href=https://github.com/marketplace class=link--external target=_blank rel=noreferrer>GitHub Marketplace</a>. Thanks to <a href=https://github.com/peaceiris class=link--external target=_blank rel=noreferrer>peaceiris</a> for the awesome work:</p><ul><li><a href=https://github.com/peaceiris/actions-hugo class=link--external target=_blank rel=noreferrer>GitHub Actions for Hugo</a></li><li><a href=https://github.com/peaceiris/actions-gh-pages class=link--external target=_blank rel=noreferrer>GitHub Actions for GitHub Pages</a></li></ul><p>Note the mapping of the environment variables required in step 4 and 5. You&rsquo;ll later configure the GitHub secrets that will be injected as environment variables into the context of the respective <code>steps</code>. The <code>GITHUB_TOKEN</code> doesn&rsquo;t need to be configured for GitHub Actions, since GitHub automatically creates it to use in your workflow. For local debugging though, you&rsquo;ll have to create a token, anyway.</p><h3 id=create-a-github-personal-access-token>Create a GitHub Personal Access Token<a href=#create-a-github-personal-access-token class=post-heading__anchor aria-hidden=true>#</a></h3><blockquote><p>Personal access tokens (PAT) are an alternative to using passwords for authentication to GitHub when using the GitHub API or the command line.</p></blockquote><p>Go to your GitHub profile&rsquo;s <a href=https://github.com/settings/tokens class=link--external target=_blank rel=noreferrer><strong>Settings</strong> → <strong>Developer settings</strong> → <strong>Personal access tokens</strong></a>. Click <strong>Generate new token</strong>, select only the <code>public_repo</code> scope and enter the note <code>schnerring.github.io</code>, to be able to later recognize what it&rsquo;s used for.</p><p>You only get one chance to copy the token&rsquo;s value, so add a new environment variable named <code>GITHUB_TOKEN</code> to your local system:</p><p><picture><source type=image/webp srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/windows-environment-variables_huc6ba7b726b93307af0dfe32067e91ba3_11242_300x0_resize_q90_h2_box_3.webp 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/windows-environment-variables_huc6ba7b726b93307af0dfe32067e91ba3_11242_500x0_resize_q90_h2_box_3.webp 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/windows-environment-variables_huc6ba7b726b93307af0dfe32067e91ba3_11242_612x0_resize_q90_h2_box_3.webp 612w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,612px"><img src=/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/windows-environment-variables.png srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/windows-environment-variables_huc6ba7b726b93307af0dfe32067e91ba3_11242_300x0_resize_box_3.png 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/windows-environment-variables_huc6ba7b726b93307af0dfe32067e91ba3_11242_500x0_resize_box_3.png 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/windows-environment-variables_huc6ba7b726b93307af0dfe32067e91ba3_11242_612x0_resize_box_3.png 612w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,612px" alt="Windows Environment Variables" loading=lazy width=612 height=246></picture></p><p>If you lose the token, just delete and then recreate it.</p><h3 id=create-the-purge_cloudflare_cachesh-script>Create the <code>purge_cloudflare_cache.sh</code> Script<a href=#create-the-purge_cloudflare_cachesh-script class=post-heading__anchor aria-hidden=true>#</a></h3><h4 id=purge-the-cloudflare-cache>Purge the Cloudflare Cache<a href=#purge-the-cloudflare-cache class=post-heading__anchor aria-hidden=true>#</a></h4><p>Use Cloudflare&rsquo;s API to <a href=https://api.cloudflare.com/#zone-purge-all-files class=link--external target=_blank rel=noreferrer>purge all cached files</a> with <code>curl</code> after successful deployment:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>curl <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --silent <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --request POST <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --header <span style=color:#e6db74>&#34;Authorization: Bearer </span><span style=color:#e6db74>${</span>CLOUDFLARE_API_TOKEN<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --header <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --data <span style=color:#e6db74>&#39;{&#34;purge_everything&#34;:true}&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#e6db74>&#34;https://api.cloudflare.com/client/v4/zones/</span><span style=color:#e6db74>${</span>CLOUDFLARE_ZONE_ID<span style=color:#e6db74>}</span><span style=color:#e6db74>/purge_cache&#34;</span>
</span></span></code></pre></div><p>Before you can run the command above, set <code>CLOUDFLARE_ZONE_ID</code> and <code>CLOUDFLARE_API_TOKEN</code> as environment variables in your GitHub repository and your workstation. You can add secrets in your GitHub repository&rsquo;s <strong>Settings</strong> → <strong>Secrets</strong> → <strong>New repository secret</strong>:</p><ul><li><p>Set <code>CLOUDFLARE_ZONE_ID</code> to your Cloudflare site&rsquo;s <strong>Zone ID</strong> which you can find it on your site&rsquo;s <strong>Overview</strong> page.</p></li><li><p>Set <code>CLOUDFLARE_API_TOKEN</code> to an API Token with <em>Zone.Cache Purge</em> permissions. Create one at <strong>My Profile</strong> → <strong>API Tokens</strong> → <strong>Create Token</strong> → <strong>Create Custom Token</strong> → <strong>Get started</strong>:</p><p><picture><source type=image/webp srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-api-token_hu14bd0a37846058da6c77855ed37eb28d_28659_300x0_resize_q90_h2_box_3.webp 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-api-token_hu14bd0a37846058da6c77855ed37eb28d_28659_500x0_resize_q90_h2_box_3.webp 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-api-token_hu14bd0a37846058da6c77855ed37eb28d_28659_700x0_resize_q90_h2_box_3.webp 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px"><img src=/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-api-token.png srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-api-token_hu14bd0a37846058da6c77855ed37eb28d_28659_300x0_resize_box_3.png 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-api-token_hu14bd0a37846058da6c77855ed37eb28d_28659_500x0_resize_box_3.png 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/cloudflare-api-token_hu14bd0a37846058da6c77855ed37eb28d_28659_700x0_resize_box_3.png 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px" alt="Cloudflare API Token" loading=lazy width=890 height=856></picture></p></li></ul><p>You should then be able to locally run the <code>curl</code> snippet above which should output <code>"success": true</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;result&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;********************************&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;success&#34;</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;errors&#34;</span>: [],
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;messages&#34;</span>: []
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=polling-the-github-pages-build-status>Polling the GitHub Pages Build Status<a href=#polling-the-github-pages-build-status class=post-heading__anchor aria-hidden=true>#</a></h4><p>Before purging the site&rsquo;s cache on Cloudflare, make sure that the GitHub Pages build completed successfully. Via GitHub&rsquo;s API, <a href=https://docs.github.com/en/free-pro-team@latest/rest/reference/repos#get-latest-pages-build class=link--external target=_blank rel=noreferrer>query the latest GitHub Pages build</a> with <code>curl</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>curl <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --silent <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --user <span style=color:#e6db74>&#34;schnerring:</span><span style=color:#e6db74>${</span>GITHUB_TOKEN<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --header <span style=color:#e6db74>&#34;Accept: application/vnd.github.v3+json&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#e6db74>&#34;https://api.github.com/repos/schnerring/schnerring.github.io/pages/builds/latest&#34;</span>
</span></span></code></pre></div><p>The <code>GITHUB_TOKEN</code> you configured earlier is used here. Executing the snippet locally will output <code>"status": "built"</code> if the GitHub Pages build succeeded:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;url&#34;</span>: <span style=color:#e6db74>&#34;https://api.github.com/repos/schnerring/schnerring.github.io/pages/builds/123456789&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;status&#34;</span>: <span style=color:#e6db74>&#34;built&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;error&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;message&#34;</span>: <span style=color:#66d9ef>null</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=put-it-all-together>Put It All Together<a href=#put-it-all-together class=post-heading__anchor aria-hidden=true>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>readonly DELAY_STEP_SECONDS<span style=color:#f92672>=</span><span style=color:#ae81ff>15</span>
</span></span><span style=display:flex><span>readonly INTERVAL_SECONDS<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>readonly TIMEOUT_SECONDS<span style=color:#f92672>=</span><span style=color:#ae81ff>120</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>readonly GITHUB_USER<span style=color:#f92672>=</span>schnerring
</span></span><span style=display:flex><span>readonly GITHUB_REPO<span style=color:#f92672>=</span>schnerring.github.io
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>##################################################</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Poll status of latest GitHub Pages build every INTERVAL_SECONDS seconds for up</span>
</span></span><span style=display:flex><span><span style=color:#75715e># to TIMEOUT_SECONDS seconds.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Globals:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   GITHUB_REPO</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   GITHUB_TOKEN</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   GITHUB_USER</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   INTERVAL_SECONDS</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   TIMEOUT_SECONDS</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Arguments:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   None</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Outputs:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   Success message to stdout or error message to stderr.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Returns:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   0 on success, 1 otherwise.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>##################################################</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> poll_build_status<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;Awaiting completion of latest GitHub Pages build ...&#34;</span>
</span></span><span style=display:flex><span>  local waited_seconds<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>while</span> <span style=color:#f92672>[[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>waited_seconds<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> -lt <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>TIMEOUT_SECONDS<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]]</span>; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> curl <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>      --silent <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>      --user <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>GITHUB_USER<span style=color:#e6db74>}</span><span style=color:#e6db74>:</span><span style=color:#e6db74>${</span>GITHUB_TOKEN<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>      --header <span style=color:#e6db74>&#34;Accept: application/vnd.github.v3+json&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>      <span style=color:#e6db74>&#34;https://api.github.com/repos/</span><span style=color:#e6db74>${</span>GITHUB_USER<span style=color:#e6db74>}</span><span style=color:#e6db74>/</span><span style=color:#e6db74>${</span>GITHUB_REPO<span style=color:#e6db74>}</span><span style=color:#e6db74>/pages/builds/latest&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>      | grep -q <span style=color:#e6db74>&#39;&#34;status&#34;: &#34;built&#34;&#39;</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>      echo <span style=color:#e6db74>&#34;Success.&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;  Sleeping </span><span style=color:#e6db74>${</span>INTERVAL_SECONDS<span style=color:#e6db74>}</span><span style=color:#e6db74> seconds until next status poll ...&#34;</span>
</span></span><span style=display:flex><span>    sleep <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>INTERVAL_SECONDS<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>((</span> waited_seconds <span style=color:#f92672>+=</span> INTERVAL_SECONDS <span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;Failure.&#34;</span> &gt;&amp;<span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>##################################################</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Purge entire Cloudflare cache.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Globals:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   CLOUDFLARE_API_TOKEN</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   CLOUDFLARE_ZONE_ID</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Arguments:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   None</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Outputs:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   Success message to stdout or error message to stderr.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Returns:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   0 on success, 1 otherwise.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>##################################################</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> purge_cache<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;Purging Cloudflare cache ...&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> curl <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --silent <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --request POST <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --header <span style=color:#e6db74>&#34;Authorization: Bearer </span><span style=color:#e6db74>${</span>CLOUDFLARE_API_TOKEN<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --header <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --data <span style=color:#e6db74>&#39;{&#34;purge_everything&#34;:true}&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    <span style=color:#e6db74>&#34;https://api.cloudflare.com/client/v4/zones/</span><span style=color:#e6db74>${</span>CLOUDFLARE_ZONE_ID<span style=color:#e6db74>}</span><span style=color:#e6db74>/purge_cache&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    | grep -q <span style=color:#e6db74>&#39;&#34;success&#34;: true&#39;</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;Success.&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;Failure.&#34;</span> &gt;&amp;<span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>##################################################</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Main function of script.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Globals:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   DELAY_STEP_SECONDS</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Arguments:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   None</span>
</span></span><span style=display:flex><span><span style=color:#75715e>##################################################</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> main<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;Sleeping </span><span style=color:#e6db74>${</span>DELAY_STEP_SECONDS<span style=color:#e6db74>}</span><span style=color:#e6db74> seconds ...&#34;</span>
</span></span><span style=display:flex><span>  sleep <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>DELAY_STEP_SECONDS<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>  poll_build_status <span style=color:#f92672>||</span> exit <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;Sleeping </span><span style=color:#e6db74>${</span>DELAY_STEP_SECONDS<span style=color:#e6db74>}</span><span style=color:#e6db74> seconds ...&#34;</span>
</span></span><span style=display:flex><span>  sleep <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>DELAY_STEP_SECONDS<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>  purge_cache <span style=color:#f92672>||</span> exit <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Entrypoint</span>
</span></span><span style=display:flex><span>main <span style=color:#e6db74>&#34;</span>$@<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p><code>poll_build_status</code> and <code>purge_cache</code> contain the functionality. The <code>main</code> function serves as the entry point executing those functions.</p><p><code>poll_build_status</code> implements a <code>while</code> loop to repeatedly poll GitHub&rsquo;s API. It succeeds if the response contains <code>"status": "built"</code> or times out after two minutes and fails.</p><p>Before each step, the script heuristically <code>sleep</code>s 15 seconds in case of latency issues with GitHub&rsquo;s API or GitHub Pages updates.</p><p>Running the <code>./purge_cloudflare_cache.sh</code> script locally should output:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Awaiting completion of latest GitHub Pages build ...
</span></span><span style=display:flex><span>Success.
</span></span><span style=display:flex><span>Purging Cloudflare cache ...
</span></span><span style=display:flex><span>Success.
</span></span></code></pre></div><p>Note that for sites with lots of files, purging the whole cache should be avoided. Cloudflare supports purging the cache for individual files.</p><p>We <em>could</em> list only changed files if we wanted to with a command like <code>git diff-tree -r --no-commit-id --name-only --diff-filter=DM gh-pages</code> and only purge the cache for these files, but that&rsquo;s out of scope for this post.</p><p>Now push <code>.github/workflows/hugo.yml</code> and <code>purge_cloudflare_cache.sh</code> to the repository:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git add -A
</span></span><span style=display:flex><span>git commit -m <span style=color:#e6db74>&#34;Add .github/workflows/hugo.yml, purge_cloudflare_cache.sh&#34;</span>
</span></span><span style=display:flex><span>git push
</span></span></code></pre></div><p>Go check out the <strong>Actions</strong> tab on your GitHub repository. If everything is configured correctly, GitHub Actions should be building your site:</p><p><picture><source type=image/webp srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/github-actions-workflows_hu1f24035c368a2da852b80f3dcf15a2e3_17827_300x0_resize_q90_h2_box_3.webp 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/github-actions-workflows_hu1f24035c368a2da852b80f3dcf15a2e3_17827_500x0_resize_q90_h2_box_3.webp 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/github-actions-workflows_hu1f24035c368a2da852b80f3dcf15a2e3_17827_700x0_resize_q90_h2_box_3.webp 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px"><img src=/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/github-actions-workflows.png srcset="/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/github-actions-workflows_hu1f24035c368a2da852b80f3dcf15a2e3_17827_300x0_resize_box_3.png 300w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/github-actions-workflows_hu1f24035c368a2da852b80f3dcf15a2e3_17827_500x0_resize_box_3.png 500w,/blog/create-a-hugo-website-with-github-pages-github-actions-and-cloudflare/github-actions-workflows_hu1f24035c368a2da852b80f3dcf15a2e3_17827_700x0_resize_box_3.png 700w" sizes="(max-width: 499px) 300px,(max-width: 699px) 500px,700px" alt="GitHub Actions Workflow" loading=lazy width=932 height=256></picture></p><p>After the workflow succeeded, there won&rsquo;t be any changes to the site because we didn&rsquo;t change anything about our site, yet.</p><p>To make a change, switch to the light theme by setting <code>defaultTheme = "light"</code> inside the <code>config.toml</code> file. Push the changes by running <code>git commit -am "Set default theme to light" && git push</code> and another GitHub Action workflow should automatically be triggered.</p><p>After the build completes, your website should be displayed in the light theme. If it isn&rsquo;t, make sure to also purge your browser cache.</p><h2 id=wrapping-up>Wrapping Up<a href=#wrapping-up class=post-heading__anchor aria-hidden=true>#</a></h2><p>It took quite a bit of effort, but you now have a hands-off system in place that helps you to publish content to your website in an automated way. All you have to do is pushing new changes to your GitHub repo and after a minute the changes will be live.</p></div><div class=social-share><strong class=social-share__heading>Share this post:</strong>
<a class=social-share__item href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fschnerring.net%2Fblog%2Fcreate-a-hugo-website-with-github-pages-github-actions-and-cloudflare%2F&amp;text=Create+a+Hugo+Website+with+GitHub+Pages%2C+GitHub+Actions%2C+and+Cloudflare" target=_blank rel=noreferrer><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitter</title><path d="M21.543 7.104c.015.211.015.423.015.636.0 6.507-4.954 14.01-14.01 14.01v-.003A13.94 13.94.0 010 19.539a9.88 9.88.0 007.287-2.041 4.93 4.93.0 01-4.6-3.42 4.916 4.916.0 002.223-.084A4.926 4.926.0 01.96 9.167v-.062a4.887 4.887.0 002.235.616A4.928 4.928.0 011.67 3.148 13.98 13.98.0 0011.82 8.292a4.929 4.929.0 018.39-4.49 9.868 9.868.0 003.128-1.196A4.941 4.941.0 0121.173 5.33 9.828 9.828.0 0024 4.555a10.019 10.019.0 01-2.457 2.549z"/></svg></a><a class=social-share__item href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fschnerring.net%2Fblog%2Fcreate-a-hugo-website-with-github-pages-github-actions-and-cloudflare%2F" target=_blank rel=noreferrer><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg></a><a class=social-share__item href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fschnerring.net%2Fblog%2Fcreate-a-hugo-website-with-github-pages-github-actions-and-cloudflare%2F" target=_blank rel=noreferrer><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Facebook</title><path d="M9.101 23.691v-7.98H6.627v-3.667h2.474v-1.58c0-4.085 1.848-5.978 5.858-5.978.401.0.955.042 1.468.103a8.68 8.68.0 011.141.195v3.325a8.623 8.623.0 00-.653-.036 26.805 26.805.0 00-.733-.009c-.707.0-1.259.096-1.675.309a1.686 1.686.0 00-.679.622c-.258.42-.374.995-.374 1.752v1.297h3.919l-.386 2.103-.287 1.564h-3.246v8.245C19.396 23.238 24 18.179 24 12.044c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.628 3.874 10.35 9.101 11.647z"/></svg></a><a class=social-share__item href="https://reddit.com/submit?url=https%3A%2F%2Fschnerring.net%2Fblog%2Fcreate-a-hugo-website-with-github-pages-github-actions-and-cloudflare%2F&amp;title=Create+a+Hugo+Website+with+GitHub+Pages%2C+GitHub+Actions%2C+and+Cloudflare" target=_blank rel=noreferrer><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Reddit</title><path d="M12 0C5.373.0.0 5.373.0 12c0 3.314 1.343 6.314 3.515 8.485l-2.286 2.286C.775 23.225 1.097 24 1.738 24H12c6.627.0 12-5.373 12-12S18.627.0 12 0zm4.388 3.199c1.104.0 1.999.895 1.999 1.999.0 1.105-.895 2-1.999 2-.946.0-1.739-.657-1.947-1.539v.002c-1.147.162-2.032 1.15-2.032 2.341v.007c1.776.067 3.4.567 4.686 1.363.473-.363 1.064-.58 1.707-.58 1.547.0 2.802 1.254 2.802 2.802.0 1.117-.655 2.081-1.601 2.531-.088 3.256-3.637 5.876-7.997 5.876-4.361.0-7.905-2.617-7.998-5.87-.954-.447-1.614-1.415-1.614-2.538.0-1.548 1.255-2.802 2.803-2.802.645.0 1.239.218 1.712.585 1.275-.79 2.881-1.291 4.64-1.365v-.01c0-1.663 1.263-3.034 2.88-3.207.188-.911.993-1.595 1.959-1.595zm-8.085 8.376c-.784.0-1.459.78-1.506 1.797-.047 1.016.64 1.429 1.426 1.429s1.371-.369 1.418-1.385c.047-1.017-.553-1.841-1.338-1.841zm7.406.0c-.786.0-1.385.824-1.338 1.841.047 1.017.634 1.385 1.418 1.385.785.0 1.473-.413 1.426-1.429-.046-1.017-.721-1.797-1.506-1.797zm-3.703 4.013c-.974.0-1.907.048-2.77.135-.147.015-.241.168-.183.305.483 1.154 1.622 1.964 2.953 1.964 1.33.0 2.47-.81 2.953-1.964.057-.137-.037-.29-.184-.305-.863-.087-1.795-.135-2.769-.135z"/></svg></a><a class=social-share__item href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Fschnerring.net%2Fblog%2Fcreate-a-hugo-website-with-github-pages-github-actions-and-cloudflare%2F&amp;t=Create+a+Hugo+Website+with+GitHub+Pages%2C+GitHub+Actions%2C+and+Cloudflare" target=_blank rel=noreferrer><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Y Combinator</title><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg></a><a class=social-share__item href="mailto:?subject=Create+a+Hugo+Website+with+GitHub+Pages%2C+GitHub+Actions%2C+and+Cloudflare&amp;body=https%3A%2F%2Fschnerring.net%2Fblog%2Fcreate-a-hugo-website-with-github-pages-github-actions-and-cloudflare%2F" target=_blank rel=noreferrer><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-mail" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 7a2 2 0 012-2h14a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V7z"/><path d="M3 7l9 6 9-6"/></svg></a></div><div id=remark42></div><script>var remark_config={host:"https://remark42.schnerring.net",site_id:"schnerring.net",theme:localStorage.getItem("theme"),show_email_subscription:!1}</script><script>!function(e,t){for(s=0;s<e.length;s++){var s,n=t.createElement("script"),o=".js",i=t.head||t.body;"noModule"in n?(n.type="module",o=".mjs"):n.async=!0,n.defer=!0,n.src=remark_config.host+"/web/"+e[s]+o,i.appendChild(n)}}(remark_config.components||["embed"],document)</script><script>const themeToggleLight=document.getElementsByClassName("theme__toggle light--hidden").item(0);themeToggleLight.addEventListener("click",()=>{setTimeout(()=>window.REMARK42.changeTheme("light"),10)});const themeToggleDark=document.getElementsByClassName("theme__toggle dark--hidden").item(0);themeToggleDark.addEventListener("click",()=>{setTimeout(()=>window.REMARK42.changeTheme("dark"),10)})</script><script>function cookieConsentClick(){localStorage.setItem("cookie-consent",!0);const e=document.getElementById("cookie-consent");e.classList.add("cookie-consent--hidden")}</script><div id=cookie-consent class=cookie-consent--hidden><div class=cli-prompt><div class=cli-prompt__chevron>>&nbsp;</div><div class=cli-prompt__text><span>When you participate in the comments, a cookie is used to keep you logged in.</span>
<span class=cli-prompt__cursor>█</span></div><button onclick=cookieConsentClick()>Got it!</button></div></div><script>const cookieConsentAccepted=localStorage&&localStorage.getItem("cookie-consent");if(!cookieConsentAccepted){const e=document.getElementById("cookie-consent");e.classList.remove("cookie-consent--hidden")}</script></article></div><div class=sidebar><aside class=bio><div class="jr__item jr-basics__item"><div class=jr-basics__image><img src=https://schnerring.net/michael-schnerring.jpg alt="Picture of Michael Schnerring" width=250 height=250></div><div class=jr-basics__name>Michael Schnerring</div><div class=jr-basics__label>Software Engineer</div><div class=jr-basics__summary>I've been a computer geek all my life. I'm passionate about open-source and digital privacy. I like video games and CrossFit. I also blog sometimes.</div><div class=jr-basics__location-city>Basel</div><div class=jr-basics__location-region>Switzerland</div><hr><div class="jr-basics__profile jr-basics__profile--row"><a href=https://github.com/schnerring target=_blank rel="noreferrer me"><div class=jr-basics__profile-item><div class=jr-basics__profile-icon><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></div></div></a><a href=https://twitter.com/schnerringo target=_blank rel="noreferrer me"><div class=jr-basics__profile-item><div class=jr-basics__profile-icon><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitter</title><path d="M21.543 7.104c.015.211.015.423.015.636.0 6.507-4.954 14.01-14.01 14.01v-.003A13.94 13.94.0 010 19.539a9.88 9.88.0 007.287-2.041 4.93 4.93.0 01-4.6-3.42 4.916 4.916.0 002.223-.084A4.926 4.926.0 01.96 9.167v-.062a4.887 4.887.0 002.235.616A4.928 4.928.0 011.67 3.148 13.98 13.98.0 0011.82 8.292a4.929 4.929.0 018.39-4.49 9.868 9.868.0 003.128-1.196A4.941 4.941.0 0121.173 5.33 9.828 9.828.0 0024 4.555a10.019 10.019.0 01-2.457 2.549z"/></svg></div></div></a><a href=https://hachyderm.io/@schnerring target=_blank rel="noreferrer me"><div class=jr-basics__profile-item><div class=jr-basics__profile-icon><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Mastodon</title><path d="M23.268 5.313c-.35-2.578-2.617-4.61-5.304-5.004C17.51.242 15.792.0 11.813.0h-.03c-3.98.0-4.835.242-5.288.309C3.882.692 1.496 2.518.917 5.127.64 6.412.61 7.837.661 9.143c.074 1.874.088 3.745.26 5.611.118 1.24.325 2.47.62 3.68.55 2.237 2.777 4.098 4.96 4.857 2.336.792 4.849.923 7.256.38.265-.061.527-.132.786-.213.585-.184 1.27-.39 1.774-.753a.057.057.0 00.023-.043v-1.809a.052.052.0 00-.02-.041.053.053.0 00-.046-.01 20.282 20.282.0 01-4.709.545c-2.73.0-3.463-1.284-3.674-1.818a5.593 5.593.0 01-.319-1.433.053.053.0 01.066-.054c1.517.363 3.072.546 4.632.546.376.0.75.0 1.125-.01 1.57-.044 3.224-.124 4.768-.422.038-.008.077-.015.11-.024 2.435-.464 4.753-1.92 4.989-5.604.008-.145.03-1.52.03-1.67.002-.512.167-3.63-.024-5.545zm-3.748 9.195h-2.561V8.29c0-1.309-.55-1.976-1.67-1.976-1.23.0-1.846.79-1.846 2.35v3.403h-2.546V8.663c0-1.56-.617-2.35-1.848-2.35-1.112.0-1.668.668-1.67 1.977v6.218H4.822V8.102c0-1.31.337-2.35 1.011-3.12.696-.77 1.608-1.164 2.74-1.164 1.311.0 2.302.5 2.962 1.498l.638 1.06.638-1.06c.66-.999 1.65-1.498 2.96-1.498 1.13.0 2.043.395 2.74 1.164.675.77 1.012 1.81 1.012 3.12z"/></svg></div></div></a><a href=https://www.linkedin.com/in/schnerring target=_blank rel="noreferrer me"><div class=jr-basics__profile-item><div class=jr-basics__profile-icon><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg></div></div></a><a href=https://schnerring.net/index.xml target=_blank rel="noreferrer me"><div class=jr-basics__profile-item><div class=jr-basics__profile-icon><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>RSS</title><path d="M19.199 24C19.199 13.467 10.533 4.8.0 4.8V0c13.165.0 24 10.835 24 24h-4.801zM3.291 17.415c1.814.0 3.293 1.479 3.293 3.295.0 1.813-1.485 3.29-3.301 3.29C1.47 24 0 22.526.0 20.71s1.475-3.294 3.291-3.295zM15.909 24h-4.665c0-6.169-5.075-11.245-11.244-11.245V8.09c8.727.0 15.909 7.184 15.909 15.91z"/></svg></div></div></a></div></div></aside></div></main><footer><div class=copyright>© 2020 - 2023 Michael Schnerring</div></footer><script src=/js/main.c26c1b7b76f4923d8125720886ede9ca08bfe20b924683914ba4c1c35d53667c6c2d764f5482d3860d36b9e58a50255bc22a03ff145555979852c5ec74f15e51.js integrity="sha512-wmwbe3b0kj2BJXIIhu3pygi/4guSRoORS6TBw11TZnxsLXZPVILThg02ueWKUCVbwioD/xRVVZeYUsXsdPFeUQ=="></script>
<script src=/js/flexsearch.b7180abe74d76577868b50f36069d09e3e49cf31635346b819c8f0dd3df3dedcd5f316aaa5e69b595fd51e5c8ca44cfaac21214b1db266fc8b93bf782aca50e5.js integrity="sha512-txgKvnTXZXeGi1DzYGnQnj5JzzFjU0a4Gcjw3T3z3tzV8xaqpeabWV/VHlyMpEz6rCEhSx2yZvyLk794KspQ5Q=="></script></div></body></html>