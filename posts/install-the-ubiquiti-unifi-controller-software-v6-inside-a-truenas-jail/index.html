<!doctype html><html lang=en><head><title>Install the Ubiquiti Unifi Controller Software v6 Inside a TrueNAS Jail ::
Michael Schnerring — Coder and Computer Enthusiast</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="To manage Ubiquiti UniFi devices, a UniFi controller is required. I own a single UniFi access point, and when initially configuring it, I installed the controller software inside a Ubuntu VirtualBox VM. Now that version 6 of the UniFi controller software is released, it&amp;rsquo;s time to upgrade. I decided to reinstall the controller inside a TrueNAS jail instead of a VirtualBox VM. When searching the interwebs, I only found lots of outdated instructions. It turns out that it&amp;rsquo;s very straightforward, so here are my quick notes on how to do it.
"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://schnerring.net/posts/install-the-ubiquiti-unifi-controller-software-v6-inside-a-truenas-jail/><link rel=stylesheet href=https://schnerring.net/assets/style.css><link rel=stylesheet href=https://schnerring.net/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://schnerring.net/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://schnerring.net/img/favicon.png><link href=https://schnerring.net/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://schnerring.net/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://schnerring.net/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://schnerring.net/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://schnerring.net/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://schnerring.net/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://schnerring.net/posts/install-the-ubiquiti-unifi-controller-software-v6-inside-a-truenas-jail/cover.png"><meta name=twitter:title content="Install the Ubiquiti Unifi Controller Software v6 Inside a TrueNAS Jail"><meta name=twitter:description content="To manage Ubiquiti UniFi devices, a UniFi controller is required. I own a single UniFi access point, and when initially configuring it, I installed the controller software inside a Ubuntu VirtualBox VM. Now that version 6 of the UniFi controller software is released, it&rsquo;s time to upgrade. I decided to reinstall the controller inside a TrueNAS jail instead of a VirtualBox VM. When searching the interwebs, I only found lots of outdated instructions. It turns out that it&rsquo;s very straightforward, so here are my quick notes on how to do it."><meta property="og:title" content="Install the Ubiquiti Unifi Controller Software v6 Inside a TrueNAS Jail"><meta property="og:description" content="To manage Ubiquiti UniFi devices, a UniFi controller is required. I own a single UniFi access point, and when initially configuring it, I installed the controller software inside a Ubuntu VirtualBox VM. Now that version 6 of the UniFi controller software is released, it&rsquo;s time to upgrade. I decided to reinstall the controller inside a TrueNAS jail instead of a VirtualBox VM. When searching the interwebs, I only found lots of outdated instructions. It turns out that it&rsquo;s very straightforward, so here are my quick notes on how to do it."><meta property="og:type" content="article"><meta property="og:url" content="https://schnerring.net/posts/install-the-ubiquiti-unifi-controller-software-v6-inside-a-truenas-jail/"><meta property="og:image" content="https://schnerring.net/posts/install-the-ubiquiti-unifi-controller-software-v6-inside-a-truenas-jail/cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-11-04T23:15:27+01:00"><meta property="article:modified_time" content="2021-11-04T23:15:27+01:00"><meta property="og:site_name" content="Michael Schnerring"><script async defer data-domain=schnerring.net src=https://plausible.schnerring.net/js/plausible.js></script></head><body><div class=container><header class=header><span class=header__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>schnerring.net</span>
<span class=logo__cursor></span></a><span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=post><h1 class=post-title>Install the Ubiquiti Unifi Controller Software v6 Inside a TrueNAS Jail</h1><div class=post-meta><span class=post-date>2021-11-04</span></div><span class=post-tags><a href=https://schnerring.net/tags/freebsd/>#FreeBSD</a>&nbsp;
<a href=https://schnerring.net/tags/jails/>#Jails</a>&nbsp;
<a href=https://schnerring.net/tags/truenas/>#TrueNAS</a>&nbsp;
<a href=https://schnerring.net/tags/ubuquiti/>#Ubuquiti</a>&nbsp;
<a href=https://schnerring.net/tags/unifi/>#UniFi</a>&nbsp;</span><figure class=post-cover><img src=https://schnerring.net/posts/install-the-ubiquiti-unifi-controller-software-v6-inside-a-truenas-jail/cover.png alt="Install the Ubiquiti Unifi Controller Software v6 Inside a TrueNAS Jail"></figure><div class=post-content><p>To manage <a href=https://www.ui.com/wi-fi>Ubiquiti UniFi devices</a>, a UniFi controller is required. I own a single UniFi access point, and when initially configuring it, I installed the controller software inside a Ubuntu VirtualBox VM. Now that version 6 of the UniFi controller software is released, it&rsquo;s time to upgrade. I decided to reinstall the controller inside a TrueNAS jail instead of a VirtualBox VM. When searching the interwebs, I only found lots of outdated instructions. It turns out that it&rsquo;s very straightforward, so here are my quick notes on how to do it.</p><p>I tested the following on TrueNAS version <code>12.0-U6</code>.</p><h2 id=install-unifi>Install UniFi</h2><p>Connect to a shell via Web GUI or SSH and fetch the latest FreeBSD release available. At the time of this writing, it was <code>12.2-RELEASE</code>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>iocage fetch
</code></pre></div><p>Connect to TrueNAS via shell and create the jail.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>iocage create --name unifi --release 12.2-RELEASE dhcp<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> boot<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</code></pre></div><p>I use DHCP reservations to manage my server IPs. Setting <code>dhcp=1</code> also sets <code>vnet=1</code> and <code>bpf=1</code>. Network configuration is out of scope for this guide. Please consult the <code>iocage</code> manual (<code>man iocage</code>) or the <a href=https://www.truenas.com/docs/core/applications/jails/>TrueNAS jails documentation</a> for more info. Setting <code>boot=1</code> enables auto-start at boot time.</p><p>Connect to the jail.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>sudo iocage console unifi
</code></pre></div><p>Once connected, run the following commands.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>pkg update <span style=color:#f92672>&amp;&amp;</span> pkg upgrade -y  <span style=color:#75715e># install updates</span>
pkg install unifi6            <span style=color:#75715e># install unifi</span>
sysrc unifi_enable<span style=color:#f92672>=</span>YES        <span style=color:#75715e># auto-start at boot</span>
service unifi start           <span style=color:#75715e># start unifi</span>
</code></pre></div><p>Connect to the UniFi controller at <code>https://&lt;jail IP>:8443</code>.</p><h2 id=updating>Updating</h2><p>Updating requires very few steps. <strong>Please backup the jail before updating</strong> to be able to roll back if something goes wrong.</p><p>Connect to the jail.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>sudo iocage console unifi
</code></pre></div><p>Once connected, run the following commands.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>service unifi stop            <span style=color:#75715e># stop unifi</span>
pkg update <span style=color:#f92672>&amp;&amp;</span> pkg upgrade -y  <span style=color:#75715e># install updates</span>
service unifi start           <span style=color:#75715e># start unifi</span>
</code></pre></div><p>And that&rsquo;s it!</p></div><div id=remark42></div><script>const defaultTheme="light";function getHelloFriendTheme(){const a=localStorage&&localStorage.getItem("theme");return a||defaultTheme}</script><script>var remark_config={host:"https://remark42.schnerring.net",site_id:"schnerring.net",theme:getHelloFriendTheme(),show_email_subscription:!1}</script><script>!function(d,b){for(var c=0,a,e,f;c<d.length;c++)a=b.createElement("script"),e=".js",f=b.head||b.body,"noModule"in a?(a.type="module",e=".mjs"):a.async=!0,a.defer=!0,a.src=remark_config.host+"/web/"+d[c]+e,f.appendChild(a)}(remark_config.components||["embed"],document)</script><script>const themeToggle=document.querySelector(".theme-toggle");themeToggle.addEventListener("click",()=>{setTimeout(()=>window.REMARK42.changeTheme(getHelloFriendTheme()),10)})</script></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><p>Copyright © 2020 Michael Schnerring</p><p xmlns:dct=http://purl.org/dc/terms/ xmlns:cc=http://creativecommons.org/ns# class=license-text><a rel=cc:attributionurl property="dct:title" href=https://github.com/schnerring/schnerring.github.io/tree/main/content>Content</a> licensed under <a rel=license href=https://creativecommons.org/licenses/by/4.0>CC BY 4.0</a></p></div></div></footer><script src=https://schnerring.net/assets/main.js></script><script src=https://schnerring.net/assets/prism.js></script></div></body></html>